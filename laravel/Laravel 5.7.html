<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GETTING STARTED | TechNotes</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="This Are My Notes">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/technotes/assets/css/0.styles.9dcdc9ce.css" as="style"><link rel="preload" href="/technotes/assets/js/app.8104ebb8.js" as="script"><link rel="preload" href="/technotes/assets/js/2.caedfb41.js" as="script"><link rel="preload" href="/technotes/assets/js/42.61c3b5d8.js" as="script"><link rel="prefetch" href="/technotes/assets/js/10.cd6f20a6.js"><link rel="prefetch" href="/technotes/assets/js/100.279a9072.js"><link rel="prefetch" href="/technotes/assets/js/101.997cf7be.js"><link rel="prefetch" href="/technotes/assets/js/102.1b1d5ddd.js"><link rel="prefetch" href="/technotes/assets/js/103.392e394b.js"><link rel="prefetch" href="/technotes/assets/js/104.52362a08.js"><link rel="prefetch" href="/technotes/assets/js/105.1d61a10e.js"><link rel="prefetch" href="/technotes/assets/js/106.0ccbe98d.js"><link rel="prefetch" href="/technotes/assets/js/107.8a8891f6.js"><link rel="prefetch" href="/technotes/assets/js/108.f97b9fc5.js"><link rel="prefetch" href="/technotes/assets/js/109.53af78e7.js"><link rel="prefetch" href="/technotes/assets/js/11.e97b9008.js"><link rel="prefetch" href="/technotes/assets/js/110.eba8e4a8.js"><link rel="prefetch" href="/technotes/assets/js/111.5a6e159d.js"><link rel="prefetch" href="/technotes/assets/js/112.df01fa26.js"><link rel="prefetch" href="/technotes/assets/js/113.78ee7edc.js"><link rel="prefetch" href="/technotes/assets/js/114.897d8424.js"><link rel="prefetch" href="/technotes/assets/js/115.42a6b59a.js"><link rel="prefetch" href="/technotes/assets/js/116.b79d8561.js"><link rel="prefetch" href="/technotes/assets/js/117.c16fe2d1.js"><link rel="prefetch" href="/technotes/assets/js/118.1fcc3485.js"><link rel="prefetch" href="/technotes/assets/js/119.a33ada80.js"><link rel="prefetch" href="/technotes/assets/js/12.9a00424a.js"><link rel="prefetch" href="/technotes/assets/js/120.76f211de.js"><link rel="prefetch" href="/technotes/assets/js/121.629643ae.js"><link rel="prefetch" href="/technotes/assets/js/122.68f73485.js"><link rel="prefetch" href="/technotes/assets/js/123.33cd021c.js"><link rel="prefetch" href="/technotes/assets/js/124.a81a84a8.js"><link rel="prefetch" href="/technotes/assets/js/125.0e39b1db.js"><link rel="prefetch" href="/technotes/assets/js/13.b6f0f7ab.js"><link rel="prefetch" href="/technotes/assets/js/14.266a7a2b.js"><link rel="prefetch" href="/technotes/assets/js/15.b7921887.js"><link rel="prefetch" href="/technotes/assets/js/16.ccd43b1e.js"><link rel="prefetch" href="/technotes/assets/js/17.113da873.js"><link rel="prefetch" href="/technotes/assets/js/18.d1f04f6f.js"><link rel="prefetch" href="/technotes/assets/js/19.47367321.js"><link rel="prefetch" href="/technotes/assets/js/20.e00a6f18.js"><link rel="prefetch" href="/technotes/assets/js/21.e4cb8c08.js"><link rel="prefetch" href="/technotes/assets/js/22.f74bf51d.js"><link rel="prefetch" href="/technotes/assets/js/23.94d192f0.js"><link rel="prefetch" href="/technotes/assets/js/24.7fad591d.js"><link rel="prefetch" href="/technotes/assets/js/25.3a54ea06.js"><link rel="prefetch" href="/technotes/assets/js/26.da1e8bec.js"><link rel="prefetch" href="/technotes/assets/js/27.e68284e7.js"><link rel="prefetch" href="/technotes/assets/js/28.a558c139.js"><link rel="prefetch" href="/technotes/assets/js/29.88cbe547.js"><link rel="prefetch" href="/technotes/assets/js/3.2769445e.js"><link rel="prefetch" href="/technotes/assets/js/30.11d87982.js"><link rel="prefetch" href="/technotes/assets/js/31.aeead8e9.js"><link rel="prefetch" href="/technotes/assets/js/32.d445d1fb.js"><link rel="prefetch" href="/technotes/assets/js/33.ec5cbdf7.js"><link rel="prefetch" href="/technotes/assets/js/34.7f3302d4.js"><link rel="prefetch" href="/technotes/assets/js/35.1a7ce302.js"><link rel="prefetch" href="/technotes/assets/js/36.49bdadae.js"><link rel="prefetch" href="/technotes/assets/js/37.36821112.js"><link rel="prefetch" href="/technotes/assets/js/38.f65f4627.js"><link rel="prefetch" href="/technotes/assets/js/39.c1665451.js"><link rel="prefetch" href="/technotes/assets/js/4.0aec5cc0.js"><link rel="prefetch" href="/technotes/assets/js/40.3c1f0ace.js"><link rel="prefetch" href="/technotes/assets/js/41.76268252.js"><link rel="prefetch" href="/technotes/assets/js/43.eef10551.js"><link rel="prefetch" href="/technotes/assets/js/44.f0f4bc2e.js"><link rel="prefetch" href="/technotes/assets/js/45.bbeeb042.js"><link rel="prefetch" href="/technotes/assets/js/46.73946476.js"><link rel="prefetch" href="/technotes/assets/js/47.3af87d7d.js"><link rel="prefetch" href="/technotes/assets/js/48.23d60ecc.js"><link rel="prefetch" href="/technotes/assets/js/49.9dc90dc8.js"><link rel="prefetch" href="/technotes/assets/js/5.752af569.js"><link rel="prefetch" href="/technotes/assets/js/50.8e52a3eb.js"><link rel="prefetch" href="/technotes/assets/js/51.654e7405.js"><link rel="prefetch" href="/technotes/assets/js/52.623485d0.js"><link rel="prefetch" href="/technotes/assets/js/53.efb7ad6a.js"><link rel="prefetch" href="/technotes/assets/js/54.0ad2f7f1.js"><link rel="prefetch" href="/technotes/assets/js/55.8b668558.js"><link rel="prefetch" href="/technotes/assets/js/56.12f3f821.js"><link rel="prefetch" href="/technotes/assets/js/57.52e3406f.js"><link rel="prefetch" href="/technotes/assets/js/58.574ff9e6.js"><link rel="prefetch" href="/technotes/assets/js/59.9d1f123b.js"><link rel="prefetch" href="/technotes/assets/js/6.32abcfcb.js"><link rel="prefetch" href="/technotes/assets/js/60.e2f235f0.js"><link rel="prefetch" href="/technotes/assets/js/61.e68a5945.js"><link rel="prefetch" href="/technotes/assets/js/62.4dbf5f15.js"><link rel="prefetch" href="/technotes/assets/js/63.929030ce.js"><link rel="prefetch" href="/technotes/assets/js/64.efefc0a8.js"><link rel="prefetch" href="/technotes/assets/js/65.a47b956c.js"><link rel="prefetch" href="/technotes/assets/js/66.7a299204.js"><link rel="prefetch" href="/technotes/assets/js/67.646e793b.js"><link rel="prefetch" href="/technotes/assets/js/68.eb547408.js"><link rel="prefetch" href="/technotes/assets/js/69.fc412058.js"><link rel="prefetch" href="/technotes/assets/js/7.ac0d8c58.js"><link rel="prefetch" href="/technotes/assets/js/70.4002346f.js"><link rel="prefetch" href="/technotes/assets/js/71.3d1e2ed5.js"><link rel="prefetch" href="/technotes/assets/js/72.e8f672bc.js"><link rel="prefetch" href="/technotes/assets/js/73.7b335297.js"><link rel="prefetch" href="/technotes/assets/js/74.36b0ab27.js"><link rel="prefetch" href="/technotes/assets/js/75.cddd03f2.js"><link rel="prefetch" href="/technotes/assets/js/76.3a34f2da.js"><link rel="prefetch" href="/technotes/assets/js/77.64ad8010.js"><link rel="prefetch" href="/technotes/assets/js/78.5b13e2bb.js"><link rel="prefetch" href="/technotes/assets/js/79.b948bb44.js"><link rel="prefetch" href="/technotes/assets/js/8.be5ada8e.js"><link rel="prefetch" href="/technotes/assets/js/80.0fc474be.js"><link rel="prefetch" href="/technotes/assets/js/81.9d3cd6c8.js"><link rel="prefetch" href="/technotes/assets/js/82.b19a306b.js"><link rel="prefetch" href="/technotes/assets/js/83.754da28b.js"><link rel="prefetch" href="/technotes/assets/js/84.563f388d.js"><link rel="prefetch" href="/technotes/assets/js/85.0706c016.js"><link rel="prefetch" href="/technotes/assets/js/86.122423e8.js"><link rel="prefetch" href="/technotes/assets/js/87.ce8632e5.js"><link rel="prefetch" href="/technotes/assets/js/88.ed52ab7f.js"><link rel="prefetch" href="/technotes/assets/js/89.0877c3c1.js"><link rel="prefetch" href="/technotes/assets/js/9.31e82567.js"><link rel="prefetch" href="/technotes/assets/js/90.8da3219b.js"><link rel="prefetch" href="/technotes/assets/js/91.b474c785.js"><link rel="prefetch" href="/technotes/assets/js/92.ee6dcaed.js"><link rel="prefetch" href="/technotes/assets/js/93.4a4cb662.js"><link rel="prefetch" href="/technotes/assets/js/94.459bca48.js"><link rel="prefetch" href="/technotes/assets/js/95.b0c565c1.js"><link rel="prefetch" href="/technotes/assets/js/96.13f144f3.js"><link rel="prefetch" href="/technotes/assets/js/97.c82c345f.js"><link rel="prefetch" href="/technotes/assets/js/98.df4fb20c.js"><link rel="prefetch" href="/technotes/assets/js/99.4f6c206b.js">
    <link rel="stylesheet" href="/technotes/assets/css/0.styles.9dcdc9ce.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/technotes/" class="home-link router-link-active"><!----> <span class="site-name">TechNotes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/technotes/keyboard-shortcuts/" class="nav-link">
  Keyboard-shortcuts
</a></div><div class="nav-item"><a href="/technotes/surveys/" class="nav-link">
  Surveys
</a></div><div class="nav-item"><a href="/technotes/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="https://github.com/umeshmk" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/technotes/keyboard-shortcuts/" class="nav-link">
  Keyboard-shortcuts
</a></div><div class="nav-item"><a href="/technotes/surveys/" class="nav-link">
  Surveys
</a></div><div class="nav-item"><a href="/technotes/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="https://github.com/umeshmk" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="getting-started"><a href="#getting-started" class="header-anchor">#</a> GETTING STARTED</h1> <h3 id="release"><a href="#release" class="header-anchor">#</a> # RELEASE</h3> <ul><li>Laravel Nova admin Dashboard</li> <li>Optional Email Verification (auth scaffholding)</li> <li>Support for guest users in authorization gates &amp; policies</li></ul> <h3 id="installation"><a href="#installation" class="header-anchor">#</a> # INSTALLATION</h3> <ul><li><strong>Install</strong> <ul><li><code>composer create-project --prefer-dist laravel/laravel blog</code></li></ul></li> <li><strong>Basic Configuration</strong> <ul><li><em>Entry point</em> <code>“public/index.php”</code></li> <li><em>Check config folder</em></li> <li><em>Folder permissions</em> <code>[sh-start.sh]</code></li> <li><em>.env file</em></li></ul></li></ul> <h3 id="configuration"><a href="#configuration" class="header-anchor">#</a> # CONFIGURATION</h3> <ul><li>Using <strong>DotEnv</strong> php library for <em>.env</em> <ul><li>Any variable in <em>.env</em> can be overwritten by <em>server/system</em> environment variables</li> <li><code>$_ENV (global php variable)</code></li> <li><em>config files</em> - <code>‘debug’ =&gt; env(“APP_DEBUG”, false)</code></li> <li><code>$environment = App::environment()</code></li></ul></li> <li><strong>Access config</strong> :- <code>$a = config::(‘app.timezone’)</code></li> <li><strong>Maintenance mode</strong> <ul><li><em>Down</em> - <code>php artisan down</code> (no queued jobs handled)</li> <li><em>Up</em> - <code>php artisan up</code> (queue resume)</li> <li><em>View file</em> :- <code>/views/errors/503.blade.php</code></li> <li><strong>Envoyer</strong> is alternative to maintenance mode with zero-downtime.</li></ul></li></ul> <h3 id="directory"><a href="#directory" class="header-anchor">#</a> # DIRECTORY</h3> <ul><li><em>app, bootstrap, config, database, public, resources, routes, storage, test, vendor</em></li> <li><strong>app</strong> <ul><li><em>Console, Exceptions, Http, Providers</em> =&gt; Created by default</li> <li><em>Broadcast, Events, Jobs, Listeners, Mail, Notifications, Policies, Rules</em> =&gt; created by artisan <code>make:xyz</code> command</li></ul></li></ul> <h3 id="deployment"><a href="#deployment" class="header-anchor">#</a> # DEPLOYMENT:</h3> <ul><li><p>Nginx configuration</p></li> <li><p>Optimizing</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">composer</span> <span class="token function">install</span> --optimize-autoloader --no-dev
php artisan config:cache
php artisan route:cache
</code></pre></div></li></ul> <h1 id="architectural-concepts"><a href="#architectural-concepts" class="header-anchor">#</a> ARCHITECTURAL CONCEPTS</h1> <h3 id="request-lifecycle"><a href="#request-lifecycle" class="header-anchor">#</a> # REQUEST LIFECYCLE</h3> <ul><li><strong>public/index.php</strong> <ul><li>require =&gt; <code>/vendor/autoload.php</code></li> <li>require once =&gt; <code>$app</code> as instance of <code>bootstrap/app.php</code></li> <li><code>$app</code> is new instance application which is indeed a <strong>service-container</strong></li> <li><em>Request is sent to <code>http or console</code> kernels</em> <ul><li><code>app/Http/Kernel.php</code></li> <li><code>app/Console/Kernel.php</code></li></ul></li> <li><em>Http Kernel works on</em> <ul><li>Tasks before request handling :- <em>logs, error handling, env variables, etc</em></li> <li>Middlewares :- <em>session, maintenance mode, csrf, etc.</em></li> <li>Takes <em>http request</em> gives <em>http response</em></li> <li>Load <em>service providers</em> from <code>config/app.php</code> <ul><li>First call for all providers =&gt; <code>register()</code></li> <li>Then call each providers =&gt; <code>boot()</code></li> <li>examples:- <em>database, queues, validation, routing, etc</em></li></ul></li> <li>Dispatch request to router <code>route/controller</code></li> <li>Return <em>reponse</em>.</li></ul></li></ul></li></ul> <h3 id="service-container"><a href="#service-container" class="header-anchor">#</a> # SERVICE CONTAINER</h3> <ul><li>Makes dependency (finding classes) easier by <strong>Dependency Injection</strong>.</li> <li><strong>Binding</strong> <ul><li>Registering <em>Class</em> or <em>Interface</em>(Service providers) in the <em>container</em> is called binding</li> <li>Makes finding dependent classes easier by
<ul><li>Using <em>namespaces</em> instead of file path</li> <li>Giving <em>instance</em> of required (dependent) classes whenever called.
<ul><li>new instance [<code>bind()</code>] =&gt; eg:- <em>User model instance</em></li> <li>same instance [<code>singleton()</code>] =&gt; eg:- <em>Request instance</em></li></ul></li></ul></li> <li><code>register()</code> in service provider does binding.</li> <li><strong>No need to bind</strong> class if it does not depend on any <em>interfaces</em></li></ul></li> <li><strong>Access container in service provider</strong> =&gt; <code>$this-&gt;app</code></li> <li><strong>Simple Binding [bind()]</strong> <ul><li>Returns a <em>new instance object</em></li> <li>Example:-<div class="language-php extra-class"><pre class="language-php"><code>  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">app</span><span class="token operator">-&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span>“HelpSpot\<span class="token constant">API</span>”<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">HelpSpot<span class="token punctuation">\</span>API</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>“HttpClient”<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><strong>Binding a Singleton [singleton()]</strong> <ul><li>Resolved only once</li> <li>Returns same instance each time</li> <li>Example:-<div class="language-php extra-class"><pre class="language-php"><code>  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">app</span><span class="token operator">-&gt;</span><span class="token function">singleton</span><span class="token punctuation">(</span>“HelSpot\<span class="token constant">API</span>”<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">HelpSpot<span class="token punctuation">\</span>API</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>“HttpClient”<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><strong>Binding Instance [instance()]</strong> <ul><li>Bind existing object instance</li> <li>Example :<div class="language-php extra-class"><pre class="language-php"><code>  <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">HelpSpot<span class="token punctuation">\</span>API</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpClient</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">app</span><span class="token operator">-&gt;</span><span class="token function">instance</span><span class="token punctuation">(</span>“HelpSpot\<span class="token constant">API</span>”<span class="token punctuation">,</span> <span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><strong>Binding primitives</strong> <ul><li>If class requires other class instance and primitive (<em>int, string etc</em>) value too</li> <li>Example:-<div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">app</span><span class="token operator">-&gt;</span><span class="token function">when</span><span class="token punctuation">(</span>“App\Http\Controller\UserController”<span class="token punctuation">)</span>
          <span class="token operator">-&gt;</span><span class="token function">needs</span><span class="token punctuation">(</span>“<span class="token variable">$anyVariable</span>”<span class="token punctuation">)</span>
          <span class="token operator">-&gt;</span><span class="token function">give</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><strong>Binding Interface To Implementation</strong> <ul><li>Say =&gt; <code>class RedisEventPusher implements EventPusher</code></li> <li>Then if <em>EventPusher</em> obj is called (type-hint) then it gives <em>RedisEventPusher</em> object</li> <li>Example:-<div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">app</span><span class="token operator">-&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span>
 	“App\Contracts\EventPusher”<span class="token punctuation">,</span>
 	“App\Services\RedisEventPusher”
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><strong>Resolving</strong> <ul><li><em>make()</em> <ul><li><code>$api = $this-&gt;app-&gt;make(“HelpSpot\API”);</code></li></ul></li> <li><em>resolve()</em> <ul><li><code>$api = resolve(“HelpSpot\API”);</code> (If $this-&gt;app is not accessible)</li></ul></li> <li><em>Automatic Injection (Type-hint)</em> <ul><li>Example:-<div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span>  <span class="token function">__construct </span><span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified type-declaration">App<span class="token punctuation">\</span>Model<span class="token punctuation">\</span>Users</span> <span class="token variable">$users</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">users</span> <span class="token operator">=</span> <span class="token variable">$users</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul></li></ul> <h3 id="service-provider"><a href="#service-provider" class="header-anchor">#</a> # SERVICE PROVIDER</h3> <ul><li><strong>Bootstraped</strong> = registering things like <em>bindings, event listeners, middleware and routes</em></li> <li><strong>Register service provider</strong> in <code>config/app.php</code></li> <li><strong>Writing a new Service provider</strong> <ul><li><code>php artisan make:provider RiakServiceProvider</code></li> <li>Must extend <code>Illuminate\Support\ServiceProvider</code> class</li> <li><em>2 basic methods</em> <ul><li><code>register()</code> <ul><li>Only binding a class into container</li></ul></li> <li><code>boot()</code> <ul><li>Called after all providers are registered.</li> <li>Can type-hint dependency if needed</li></ul></li></ul></li> <li>Register service provider in <em>config/app.php</em></li></ul></li> <li><strong>Deferred services</strong> loaded when required</li></ul> <h3 id="facades"><a href="#facades" class="header-anchor">#</a> # FACADES</h3> <ul><li><strong>STATIC</strong> interface to classes in service container</li> <li><strong>Working</strong> <ul><li>A new facade class extends baseclass <code>Illuminate\Support\Facades\Facade</code></li> <li>Base class uses <code>_callStatic()</code> magic-method to pass commands to object resolved from container.</li> <li>example:<div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">class</span> Cache <span class="token keyword">extends</span> <span class="token class-name">Facade</span><span class="token punctuation">{</span>
  <span class="token comment">// No static methods like get()</span>
  <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">getFacadeAccessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// return name of service container binding</span>
  <span class="token comment">// Then laravel resolves name to object and runs get() on obj</span>
  <span class="token keyword">return</span> ‘cache’<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><strong>Using any class as a</strong> <ul><li><em>Dependency injection</em> <ul><li>Import =&gt; <code>use App\Contracts\Publisher;</code></li> <li>Apply =&gt; <code>public function publish(Publisher $p)</code></li></ul></li> <li><em>Facade</em> <ul><li>Import =&gt; <code>use Facade\App\Contracts\Publisher;</code></li> <li>Apply =&gt; <code>Publisher::anyMethod()</code></li></ul></li></ul></li></ul> <h3 id="contracts"><a href="#contracts" class="header-anchor">#</a> # CONTRACTS</h3> <ul><li><strong>Set of interfaces</strong> <ul><li>eg: <code>Illuminate\Contracts\Queue\Queue</code></li> <li>Laravel Implements <em>Queue</em> with variety of drivers</li></ul></li></ul> <h1 id="basics"><a href="#basics" class="header-anchor">#</a> BASICS</h1> <h3 id="routes"><a href="#routes" class="header-anchor">#</a> # ROUTES</h3> <ul><li><p>Folder <code>routes</code> with 4 files <em>[web / api / console / channel]</em></p></li> <li><p><strong>App\Providers\RouteServiceProvider</strong></p> <ul><li>Uses <em>web</em> middleware to <code>routes/web,php</code></li> <li>Uses <code>/api</code> prefix to url with <em>api</em> middleware to <code>routes/api.php</code></li></ul></li> <li><p><strong>Methods</strong></p> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>“url”<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">[</span>get<span class="token punctuation">,</span> post<span class="token punctuation">,</span> put<span class="token punctuation">,</span> patch<span class="token punctuation">,</span> delete<span class="token punctuation">,</span> options<span class="token punctuation">]</span>
       <span class="token operator">::</span><span class="token keyword">match</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>‘get’<span class="token punctuation">,</span> ‘post’<span class="token punctuation">]</span><span class="token punctuation">,</span> “url”<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token operator">::</span><span class="token function">any</span><span class="token punctuation">(</span>“url”<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token operator">::</span><span class="token function">except</span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘get’<span class="token punctuation">,</span> ‘post’<span class="token punctuation">]</span><span class="token punctuation">,</span> “url”<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token operator">::</span><span class="token function">redirect </span><span class="token punctuation">(</span>‘<span class="token operator">/</span>here’<span class="token punctuation">,</span> ‘<span class="token operator">/</span>there’<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token operator">::</span><span class="token function">redirect </span><span class="token punctuation">(</span>‘<span class="token operator">/</span>here’<span class="token punctuation">,</span> ‘<span class="token operator">/</span>there’<span class="token punctuation">,</span> statusCodeLike301<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token operator">::</span><span class="token function">view </span><span class="token punctuation">(</span>‘ url’<span class="token punctuation">,</span> ‘viewFile ‘<span class="token punctuation">,</span> <span class="token punctuation">[</span>“key” <span class="token operator">=&gt;</span> “value”<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>CSRF Protection</strong> (in Forms) [<em>post, put, delete</em>]</p> <ul><li><code>@csrf</code></li></ul></li> <li><p><strong>Route Parameters</strong> (Note: cannot use ‘-’ for parameter name)</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>“user<span class="token operator">/</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token operator">/</span>photos<span class="token operator">/</span><span class="token punctuation">{</span> <span class="token variable">$pid</span> <span class="token punctuation">}</span>”<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token variable">$pid</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> …<span class="token operator">.</span><span class="token operator">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>  “user<span class="token operator">/</span><span class="token punctuation">{</span> name<span class="token operator">?</span> <span class="token punctuation">}</span>”<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$name</span> <span class="token operator">=</span> ”Umesh”<span class="token punctuation">)</span> <span class="token punctuation">{</span> …<span class="token operator">.</span><span class="token operator">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>Regular Expression</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>“user<span class="token operator">/</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span>”<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> …<span class="token operator">.</span><span class="token operator">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">where </span><span class="token punctuation">(</span>“id”<span class="token punctuation">,</span> “<span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><em>Global Route Parameter</em> (Applys to all routes parameters with same name)
<ul><li>In <em>RouteServiceProvider</em> method <code>boot()</code></li> <li><code>Route::pattern (‘id’, ‘[0-9]+’);</code></li></ul></li></ul></li> <li><p><strong>Named Routes</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>“url”<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">name </span><span class="token punctuation">(</span>“myroute”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><em>Making urls</em> <ul><li><code>route (“myroute”, [“id” =&gt; 232]);</code></li></ul></li> <li><em>Redirect url</em> <ul><li><code>redirect()-&gt;route (“myroute”, [‘id’ =&gt; 232]);</code></li></ul></li></ul></li> <li><p><strong>Route Group</strong></p> <ul><li>Merged =&gt; <em>Middlewares, where</em></li> <li>Appended =&gt; <em>nameprefixes, namespaces, urlprefixes</em></li></ul> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">middleware </span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘first’<span class="token punctuation">,</span> ‘second’<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token function">group </span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>‘<span class="token operator">/</span>’<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">post </span><span class="token punctuation">(</span>‘user<span class="token operator">/</span>create’<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token keyword">namespace</span> <span class="token punctuation">(</span>‘Admin’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">group </span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> …… <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment"># Namespace of group will be  App\Http\Controllers\Admin</span>

  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">domain </span><span class="token punctuation">(</span>‘ <span class="token punctuation">{</span> username <span class="token punctuation">}</span><span class="token operator">.</span>myapp<span class="token operator">.</span>com’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">group </span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>project<span class="token operator">/</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span>’<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> …<span class="token operator">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">prefix </span><span class="token punctuation">(</span>‘admin’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">group </span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> …<span class="token operator">.</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">name </span><span class="token punctuation">(</span>‘admin’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">group </span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> …<span class="token operator">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>Route-Model binding</strong></p> <ul><li><em>Implicit</em><div class="language-php extra-class"><pre class="language-php"><code>  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>“users<span class="token operator">/</span><span class="token punctuation">{</span>user<span class="token punctuation">}</span>”<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified type-declaration">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>User</span> <span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">{</span> …<span class="token operator">.</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>Note</strong> : variable <code>$user</code> and parameter <code>{ user }</code> has same name.</li> <li>If want to use <strong>slug</strong> instead of <strong>id</strong> as default key for <code>users</code> database table
<ul><li>In <code>App/Models/User</code> - <code>public function getRouteKeyName() { return “slug”; }</code></li></ul></li></ul></li> <li><em>Explicit</em> <ul><li>Same as Implicit but adding In <em>RouteServiceProviders</em> method <code>boot()</code></li> <li><code>Route::model(‘user’, ‘App\Models\User::class);</code></li></ul></li></ul></li> <li><p><strong>Fallback Route</strong> (Always at end of all routes)</p> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">fallback </span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>Rate Limiting</strong></p> <ul><li>Throttle middleware is to be assigned to <em>route / group</em></li></ul> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token comment"># throttle:60,1 =&gt; 60 request / 1 minute</span>
  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">middleware </span><span class="token punctuation">(</span>‘<span class="token argument-name">auth</span><span class="token punctuation">:</span>api’<span class="token punctuation">,</span> ‘<span class="token argument-name">throttle</span><span class="token punctuation">:</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">1</span>’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token operator">.</span><span class="token operator">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>Form method spoofing</strong></p> <ul><li><code>@method(‘put’)</code></li></ul></li> <li><p><strong>Accessing current route</strong></p> <ul><li><code>Route::current();</code> <ul><li><code>[current(), currentRouteName(), currentRouteAction()]</code></li></ul></li></ul> <h3 id="middlewares"><a href="#middlewares" class="header-anchor">#</a> # MIDDLEWARES</h3></li> <li><p><strong>Folder</strong> =&gt; <code>app/Http/Middleware</code></p></li> <li><p><strong>Command</strong> =&gt; <code>php artisan make:middleware CheckAge</code></p></li> <li><p><strong>Register</strong> =&gt; <code>app/Http/Kernel.php</code></p> <ul><li><em>Global Middlewares</em> =&gt; <code>$middleware</code></li> <li><em>Individual route by adding key name</em> =&gt; <code>$routeMiddleware</code></li> <li><em>web / api routes group</em> =&gt; <code>$middlewareGroups</code></li> <li><em>Sorting middleware</em> =&gt; <code>$middlewarePriority</code></li></ul></li> <li><p><strong>Run</strong> =&gt; <code>handle()</code> in middleware</p> <ul><li><em>Before request</em><div class="language-php extra-class"><pre class="language-php"><code>  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle </span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Closure</span> <span class="token variable">$next</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment"># do work here</span>
    <span class="token keyword">return</span> <span class="token variable">$next</span> <span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div></li> <li><em>After request</em><div class="language-php extra-class"><pre class="language-php"><code>  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle </span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Closure</span> <span class="token variable">$next</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token variable">$next</span> <span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment"># do work here</span>
    <span class="token keyword">return</span> <span class="token variable">$response</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul> <h3 id="csrf-protection"><a href="#csrf-protection" class="header-anchor">#</a> # CSRF PROTECTION</h3> <ul><li><strong>CSRF</strong> =&gt; <em>Cross-site request forgery</em> <ul><li><code>VerifyCsrfToken</code> Middleware added in <code>web</code> middleware group.</li> <li>Unauthorized commands by authenticated user</li></ul></li> <li>Laravel automatically generates <em>csrf-token</em> for each active session</li> <li><strong>Blade directive in each form</strong> =&gt; <code>@csrf</code></li> <li><strong>Exclude some URI</strong> <ul><li>In <code>VerifyCsrfToken</code> =&gt; <code>$except</code></li></ul></li> <li><strong>x-csrf-token</strong> (Ajax requests)
<ul><li><em>Add</em> =&gt;</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string double-quoted-string">&quot;csrf-token&quot;</span> content<span class="token operator">=</span><span class="token string double-quoted-string">&quot;{{ csrf_token() }}&quot;</span><span class="token operator">&gt;</span>
</code></pre></div><ul><li><em>Axios HTTP Library</em> <ul><li>Default library by laravel</li> <li><code>csrf</code> is applied to all ajax request in <code>resources/js/bootstrap.js</code></li></ul></li> <li><em>Jquery</em><div class="language-js extra-class"><pre class="language-js"><code>$<span class="token punctuation">.</span><span class="token function">ajaxSetup</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>
  headers <span class="token operator">:</span> <span class="token punctuation">{</span>
    ‘<span class="token constant">X</span><span class="token operator">-</span><span class="token constant">CSRF</span><span class="token operator">-</span><span class="token constant">TOKEN</span>’ <span class="token operator">:</span> <span class="token function">$</span><span class="token punctuation">(</span>‘meta<span class="token punctuation">[</span>name <span class="token operator">=</span> “csrf<span class="token operator">-</span>token”<span class="token punctuation">]</span>’<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span>‘content’<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><strong>x-xsrf-token</strong> <ul><li>Csrf stored in <em>cookie</em> having <code>“XSRF-TOKEN”</code> key</li> <li><em>Angular, Axios, etc</em> <strong>automatically</strong> uses this key to set the <code>x-xsrf-token</code> header</li></ul></li></ul> <h3 id="controllers"><a href="#controllers" class="header-anchor">#</a> # CONTROLLERS</h3> <ul><li><p><strong>Path</strong> : <code>app/Http/Controllers</code></p></li> <li><p>Extends <strong>Base Controller</strong> (optional) provide methods like</p> <ul><li><code>middleware(), validate(), dispatch()</code></li></ul></li> <li><p><strong>Use</strong></p> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>“uri”<span class="token punctuation">,</span> “Media\PhotoController@index“<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>Invokable</strong></p> <ul><li>Only 1 method <code>__invoke()</code> in controller</li> <li><em>No @action</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>“url”<span class="token punctuation">,</span> “MyController”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p><strong>Middleware</strong></p> <ul><li>In <code>__construct()</code> method we can add middlewares<div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">middleware</span><span class="token punctuation">(</span>‘auth’<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">middleware</span><span class="token punctuation">(</span>‘log’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">only</span><span class="token punctuation">(</span>‘index’<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">middleware</span><span class="token punctuation">(</span>‘subscribe’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">except</span><span class="token punctuation">(</span>‘index’<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p><strong>Resource / CRUD</strong></p> <ul><li><p><em>Create</em> - <code>php artisan make:controller MyController --resource</code></p></li> <li><p><em>Only/Except</em></p> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">resource</span><span class="token punctuation">(</span>“url”<span class="token punctuation">,</span> “MyController”<span class="token punctuation">)</span> <span class="token operator">-&gt;</span><span class="token function">only </span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘index’<span class="token punctuation">,</span> ‘create’ <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                         <span class="token operator">-&gt;</span><span class="token function">except </span><span class="token punctuation">(</span><span class="token punctuation">[</span>“destroy”<span class="token punctuation">,</span> “store” <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><em>Actions</em></p> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token argument-name">GET</span> 		 <span class="token punctuation">:</span>  <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">edit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token argument-name">POST</span>		 <span class="token punctuation">:</span>  <span class="token function">store</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token constant">PUT</span><span class="token operator">/</span><span class="token argument-name">PATCH</span>	 <span class="token punctuation">:</span>  <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token argument-name">DELETE</span>	 <span class="token punctuation">:</span>  <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p><em>Urls</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token operator">/</span><span class="token argument-name">photos</span>			        <span class="token punctuation">:</span>	<span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">store</span><span class="token punctuation">(</span><span class="token punctuation">)</span>l
<span class="token operator">/</span>photos<span class="token operator">/</span><span class="token argument-name">create</span> 		    <span class="token punctuation">:</span>	<span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">/</span>photos<span class="token operator">/</span><span class="token punctuation">{</span> photo <span class="token punctuation">}</span><span class="token operator">/</span><span class="token argument-name">edit</span>	<span class="token punctuation">:</span>	<span class="token function">edit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">/</span>photos<span class="token operator">/</span><span class="token punctuation">{</span> photo <span class="token punctuation">}</span>		<span class="token punctuation">:</span>	<span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p><em>Naming</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">resource </span><span class="token punctuation">(</span>‘photos’<span class="token punctuation">,</span> ‘PhotoController’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">name </span><span class="token punctuation">(</span><span class="token punctuation">[</span>
	‘create’ <span class="token operator">=&gt;</span> ‘photos<span class="token operator">.</span>build’
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><em>Parameters</em></p> <ul><li><em>Singularized</em> version of <code>Photos</code> ie <code>photo</code></li> <li>Override <code>photos / { photo }</code> with <code>photos / { admin_photo }</code> <ul><li><code>………-&gt;parameters ([‘photos’ =&gt; ‘admin_photo’]);</code></li></ul></li></ul></li> <li><p><em>__contruct()</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__contruct </span><span class="token punctuation">(</span><span class="token class-name type-declaration">UserRepository</span> <span class="token variable">$user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><em>Route Parameter &amp; Dependency</em></p> <ul><li>First dependencies then parameters
<ul><li><code>public function store (Request $r, $id) { …… }</code></li></ul></li></ul></li> <li><p><em>Route caching</em></p> <div class="language-php extra-class"><pre class="language-php"><code>php artisan <span class="token argument-name">route</span><span class="token punctuation">:</span>cache
php artisan <span class="token argument-name">route</span><span class="token punctuation">:</span>clear
</code></pre></div></li></ul></li></ul> <h3 id="requests"><a href="#requests" class="header-anchor">#</a> # REQUESTS</h3> <ul><li><p><strong>use Illuminate\Http\Request;</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">store </span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$idparameter</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> …<span class="token operator">.</span><span class="token operator">.</span> <span class="token punctuation">}</span>

<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token punctuation">)</span>             <span class="token comment"># foo/bar</span>
        <span class="token operator">-&gt;</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span>              <span class="token comment"># http://abc.com/foo/bar</span>
        <span class="token operator">-&gt;</span><span class="token function">fullUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span>          <span class="token comment"># http://abc.com/foo/bar?id=34&amp;name=umesh</span>
        <span class="token operator">-&gt;</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token comment"># get</span>
        <span class="token operator">-&gt;</span><span class="token function">isMethod</span><span class="token punctuation">(</span>‘post’<span class="token punctuation">)</span>   <span class="token comment"># true/false</span>
</code></pre></div></li> <li><p><strong>Input checking for malicious code</strong></p> <ul><li>Middlewares (global)
<ul><li><em>TrimStrings</em> and <em>ConvertEmptyStringsToNull</em></li></ul></li></ul></li> <li><p><strong>Retrieving Input</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-&gt;</span><span class="token function">input </span><span class="token punctuation">(</span>“name”<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">input </span><span class="token punctuation">(</span>“name”<span class="token punctuation">,</span> “umesh”<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">input </span><span class="token punctuation">(</span>“products<span class="token operator">.</span><span class="token number">0.</span>name”<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment"># If arrays then use dot operator</span>
        <span class="token operator">-&gt;</span><span class="token function">Input </span><span class="token punctuation">(</span>“products<span class="token operator">.</span>\<span class="token operator">*</span><span class="token operator">.</span>name”<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">#  Gives array of all names</span>
</code></pre></div></li> <li><p><strong>Retrieving Input (query string)</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">query </span><span class="token punctuation">(</span>‘name’<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">query </span><span class="token punctuation">(</span>‘name’<span class="token punctuation">,</span> ‘Umesh’<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment"># Gives all query inputs</span>
</code></pre></div></li> <li><p><strong>Retrieving Input (dynamic properties)</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token property">name</span>                           <span class="token comment"># Any form field names</span>
        <span class="token operator">-&gt;</span><span class="token property">age</span>
</code></pre></div></li> <li><p><strong>Retrieving input (JSON)</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">input </span><span class="token punctuation">(</span>“user<span class="token operator">.</span>name”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>Retrieving Input (portion only)</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">only </span><span class="token punctuation">(</span><span class="token punctuation">[</span>“name”<span class="token punctuation">,</span> “password”<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">only </span><span class="token punctuation">(</span>“name”<span class="token punctuation">,</span> “password”<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">except </span><span class="token punctuation">(</span>“name”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>Determine Input (present / absent)</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">has </span><span class="token punctuation">(</span>“name”<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">has </span><span class="token punctuation">(</span><span class="token punctuation">[</span>“name”<span class="token punctuation">,</span> “age”<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">filled </span><span class="token punctuation">(</span>“‘name”<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment"># If present and NOT EMPTY</span>
</code></pre></div></li> <li><p><strong>Old Input</strong></p> <ul><li>Handled automatically if built-in solution is used</li> <li><em>Only 1 next request the input is saved</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">flash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">flashOnly </span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘name’<span class="token punctuation">,</span> ‘age’<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">flashExcept </span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘password’<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Flash &amp; redirect</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">redirect </span><span class="token punctuation">(</span>‘myform’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">withInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          <span class="token operator">-&gt;</span><span class="token function">withInput </span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘name’<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Retrieve Old Input</em><div class="language-php extra-class"><pre class="language-php"><code>request<span class="token operator">-&gt;</span><span class="token function">old </span><span class="token punctuation">(</span>‘name’<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># &lt; input tupe=”text” value=”{{ old (‘name’) }}” &gt;</span>
</code></pre></div></li></ul></li> <li><p><strong>Cookies (retrieve)</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Cookie</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>‘name’<span class="token punctuation">)</span><span class="token string backtick-quoted-string">` &amp; `</span><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">cookie </span><span class="token punctuation">(</span>‘name’<span class="token punctuation">)</span>
</code></pre></div></li> <li><p><strong>Files</strong></p> <ul><li><em>Retrieve uploaded files</em><div class="language-php extra-class"><pre class="language-php"><code>  <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">file </span><span class="token punctuation">(</span>“photo”<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token operator">-&gt;</span><span class="token property">photo</span><span class="token punctuation">;</span>
          <span class="token operator">-&gt;</span><span class="token function">hasFile </span><span class="token punctuation">(</span>“photo”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Valid file</em> <ul><li><code>$request-&gt;file (“photo”)-&gt;isValid();</code></li></ul></li> <li><em>File path &amp; extension</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">file </span><span class="token punctuation">(</span>“photo”<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token operator">-&gt;</span><span class="token function">extension</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Store uploaded files</em> <ul><li><code>config/filesystems.php</code></li> <li><code>store()</code> <ul><li><em>uniqueid</em> as filename</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">file </span><span class="token punctuation">(</span>“photo”<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">store </span><span class="token punctuation">(</span>“path”<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">store </span><span class="token punctuation">(</span>“path”<span class="token punctuation">,</span> ”s3”<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">storeAs </span><span class="token punctuation">(</span>“path”<span class="token punctuation">,</span> “filename<span class="token operator">.</span>jpg”<span class="token punctuation">,</span> “s3”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li></ul></li></ul> <h3 id="responses"><a href="#responses" class="header-anchor">#</a> # RESPONSES</h3> <ul><li><p><strong>Create Response</strong></p> <ul><li><p><em>String &amp; Arrays</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> “hello world”<span class="token punctuation">;</span>
       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><em>Objects</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">response </span><span class="token punctuation">(</span>“hello”<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">header </span><span class="token punctuation">(</span>“content<span class="token operator">-</span>type”<span class="token punctuation">,</span> “text<span class="token operator">/</span>plain”<span class="token punctuation">)</span><span class="token punctuation">;</span>
                              <span class="token operator">-&gt;</span><span class="token function">header </span><span class="token punctuation">(</span>“foo”<span class="token punctuation">,</span> “bar”<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token function">response </span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">withHeaders </span><span class="token punctuation">(</span><span class="token punctuation">[</span>
	“<span class="token constant">H1</span>” <span class="token operator">=&gt;</span> “v1”<span class="token punctuation">,</span>
	“<span class="token constant">H2</span>” <span class="token operator">=&gt;</span> “v2”<span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><em>Attach cookies</em></p> <ul><li>Encrypted &amp; signed by <strong>EncryptCookies</strong> Middleware</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">response </span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">cookie </span><span class="token punctuation">(</span>“name”<span class="token punctuation">,</span> “value”<span class="token punctuation">,</span> <span class="token variable">$minutes</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p><strong>Redirects</strong></p> <ul><li><em>Global helper</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">redirect </span><span class="token punctuation">(</span>“url”<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">withInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Named routes</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">route </span><span class="token punctuation">(</span>“RouteName”<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token operator">-&gt;</span><span class="token function">route </span><span class="token punctuation">(</span>“RouteName”<span class="token punctuation">,</span> <span class="token punctuation">[</span>‘id’ <span class="token operator">=&gt;</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Actions</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">actions </span><span class="token punctuation">(</span>“MyController@index” <span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token operator">-&gt;</span><span class="token function">actions </span><span class="token punctuation">(</span>“MyController@index” <span class="token punctuation">,</span> <span class="token punctuation">[</span>“id” <span class="token operator">=&gt;</span> “value”<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>External domain</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">away </span><span class="token punctuation">(</span>“<span class="token argument-name">https</span><span class="token punctuation">:</span><span class="token comment">//google.com”);</span>
</code></pre></div></li> <li><em>With session data</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">redirect </span><span class="token punctuation">(</span>“url”<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">with </span><span class="token punctuation">(</span>“Key”<span class="token punctuation">,</span> “Value”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><p><strong>Other response types</strong></p> <ul><li><em>View</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">view </span><span class="token punctuation">(</span>“hello”<span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">header </span><span class="token punctuation">(</span>“<span class="token constant">H1</span>”<span class="token punctuation">,</span> “<span class="token constant">V1</span>”<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># Note: use global view() helper method if custom header not needed</span>
</code></pre></div></li> <li><em>Json</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">json </span><span class="token punctuation">(</span><span class="token punctuation">[</span>“name” <span class="token operator">=&gt;</span> “umesh”<span class="token punctuation">,</span> “age” <span class="token operator">=&gt;</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># Content-type is set to application/json &amp; array is converted to json</span>
</code></pre></div></li> <li><em>Download</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">download </span><span class="token punctuation">(</span>“path”<span class="token punctuation">,</span> “name<span class="token operator">.</span>jpg”<span class="token punctuation">,</span> <span class="token variable">$headerOptional</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token operator">-&gt;</span><span class="token function">download </span><span class="token punctuation">(</span>“path”<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token operator">-&gt;</span><span class="token function">download </span><span class="token punctuation">(</span>“path”<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">deleteFileAfterSend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Open in browser (pdf / images)</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">file </span><span class="token punctuation">(</span>“path”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li></ul> <h3 id="views"><a href="#views" class="header-anchor">#</a> # VIEWS</h3> <ul><li><p><strong>File</strong> - <code>resources/views/welcome.blade.php</code></p></li> <li><p><strong>Return View</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token function">view </span><span class="token punctuation">(</span>“welcome”<span class="token punctuation">,</span> <span class="token punctuation">[</span>“name” <span class="token operator">=&gt;</span> “james”<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">view </span><span class="token punctuation">(</span>“welcome”<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">with </span><span class="token punctuation">(</span><span class="token punctuation">[</span>“name” <span class="token operator">=&gt;</span> “james”<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>Variable shared with all views</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment"># AppServiceProvider or MyProvider</span>
<span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name static-context">View</span><span class="token operator">::</span><span class="token function">share </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> ‘value’<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><strong>Composer</strong></p> <ul><li><p>Composer is a class method called during rendering of view</p></li> <li><p><em>Location</em> : “app/Http/View/Composers/ProfileComposer”</p></li> <li><p><em>Register composer</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment"># ViewServiceProvider</span>
<span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name static-context">View</span><span class="token operator">::</span><span class="token function">composer </span><span class="token punctuation">(</span>‘profile’<span class="token punctuation">,</span> ‘App\Http\View\Composers\ProfileComposer’<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment"># File based ‘profile.blade.php’</span>
  <span class="token class-name static-context">View</span><span class="token operator">::</span><span class="token function">composer </span><span class="token punctuation">(</span>‘profile’<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> ………<span class="token operator">.</span><span class="token operator">.</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment"># Closure based</span>

  <span class="token comment"># Muliple views : [‘profile’, ‘home’, ‘welcome’]</span>
  <span class="token comment"># all views : “\*”</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><em>ProfileComposer</em></p> <ul><li><code>compose()</code> called whenever profile view is rendered &amp; <code>$count</code> variable available</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">compose </span><span class="token punctuation">(</span><span class="token class-name type-declaration">View</span> <span class="token variable">$view</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">UserRepo</span> <span class="token variable">$users</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token variable">$view</span><span class="token operator">-&gt;</span><span class="token function">with </span><span class="token punctuation">(</span>‘count’<span class="token punctuation">,</span> <span class="token variable">$users</span><span class="token operator">-&gt;</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul> <h3 id="url-generations"><a href="#url-generations" class="header-anchor">#</a> # URL GENERATIONS</h3> <ul><li><strong>Basics</strong><div class="language-php extra-class"><pre class="language-php"><code><span class="token function">url </span><span class="token punctuation">(</span>“posts<span class="token operator">/</span><span class="token number">11</span>”<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment"># https://example.com/posts/11</span>
<span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment"># without query</span>
     <span class="token operator">-&gt;</span><span class="token function">full</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token operator">-&gt;</span><span class="token function">previous</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><strong>Named Route</strong><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">route </span><span class="token punctuation">(</span>“RouteName”<span class="token punctuation">,</span> <span class="token punctuation">[</span>‘id’ <span class="token operator">=&gt;</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><strong>Signed urls</strong><div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">URL</span><span class="token operator">::</span><span class="token function">signedRoute </span><span class="token punctuation">(</span>“unsubscribe”<span class="token punctuation">,</span> <span class="token punctuation">[</span>“user” <span class="token operator">=&gt;</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token operator">::</span><span class="token function">temporarySignedRoute </span><span class="token punctuation">(</span>‘unsubscribe”<span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">addMinutes </span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>“user” <span class="token operator">=&gt;</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><em>Validation of sign</em> (can be a middleware)
<ul><li><code>$request-&gt;hasValidSignature()</code></li></ul></li></ul></li> <li><strong>Controllers actions</strong><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token function">action </span><span class="token punctuation">(</span>“homeController@show”<span class="token punctuation">,</span> <span class="token punctuation">[</span>‘id’ <span class="token operator">=&gt;</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="sessions"><a href="#sessions" class="header-anchor">#</a> # SESSIONS</h3> <ul><li><strong>Introduction</strong> <ul><li>HTTP is <em>stateless</em> protocol</li> <li><em>config/session.php</em> <ul><li>Options : <code>file, cookie, database, redis, memcached</code></li></ul></li> <li><em>database (table)</em> <ul><li><code>php artisan session:table</code></li></ul></li> <li><em>redis</em> <ul><li><code>composer require predis/predis</code></li> <li>See <code>config/database.php</code></li></ul></li></ul></li> <li><strong>Using Sessions</strong> <ul><li><em>Retrieve key value</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get </span><span class="token punctuation">(</span>“key”<span class="token punctuation">)</span><span class="token punctuation">;</span>
                   <span class="token operator">-&gt;</span><span class="token function">get </span><span class="token punctuation">(</span>“key”<span class="token punctuation">,</span> “<span class="token keyword">default</span>”<span class="token punctuation">)</span><span class="token punctuation">;</span>
                   <span class="token operator">-&gt;</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># OR</span>
<span class="token function">session </span><span class="token punctuation">(</span>“key”<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span>“key”<span class="token punctuation">,</span> “<span class="token keyword">default</span>”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Store new key</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">put </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> ‘value’<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># OR</span>
<span class="token function">session </span><span class="token punctuation">(</span><span class="token punctuation">[</span>“key”  <span class="token operator">=&gt;</span> “value”<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Push / Pull</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">push </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> ‘value’<span class="token punctuation">)</span><span class="token punctuation">;</span>
                   <span class="token operator">-&gt;</span><span class="token function">pull </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> ‘<span class="token keyword">default</span>’<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># returns key or default value</span>
</code></pre></div></li> <li><em>has / exits</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">exists </span><span class="token punctuation">(</span>“key”<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment"># value can be null</span>
                   <span class="token operator">-&gt;</span><span class="token function">has </span><span class="token punctuation">(</span>“key”<span class="token punctuation">)</span><span class="token punctuation">;</span>		    <span class="token comment"># value Not null</span>
</code></pre></div></li> <li><em>Flash data</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">flash </span><span class="token punctuation">(</span>“status”<span class="token punctuation">,</span> “Successful”<span class="token punctuation">)</span><span class="token punctuation">;</span>
                   <span class="token operator">-&gt;</span><span class="token function">reflash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   <span class="token operator">-&gt;</span><span class="token function">keep </span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘name’<span class="token punctuation">,</span> ‘age’<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Remove</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">forget </span><span class="token punctuation">(</span>“key”<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">forget </span><span class="token punctuation">(</span><span class="token punctuation">[</span>“key”<span class="token punctuation">,</span> “key2”<span class="token operator">...</span><span class="token operator">...</span><span class="token operator">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">-&gt;</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Regenerate session id</em> (Done automatically on user login)<div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">regenerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li></ul> <h3 id="validation"><a href="#validation" class="header-anchor">#</a> # VALIDATION</h3> <ul><li><p><strong>Validate()</strong></p> <ul><li><em>If validation fails response is automatic</em> <ul><li><em>http response</em> for http request (redirect to previous)</li> <li><em>json response</em> for ajax request</li></ul></li> <li>Ex:<div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$valid</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">validate </span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  “title” <span class="token operator">=&gt;</span> “<span class="token class-name">required</span> <span class="token operator">|</span> <span class="token argument-name">max</span><span class="token punctuation">:</span><span class="token number">255</span>” <span class="token punctuation">,</span>
  “age” <span class="token operator">=&gt;</span> “required”
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><strong>bail</strong> rule to stop checking for next rule after a rule fails</li> <li><em>Null values</em> <ul><li>Uses middlewares : <code>TrimString</code> &amp; <code>ConvertEmptyStringsToNull</code></li> <li><code>null</code> values gives validation error. So use <em>nullable</em> rule
<ul><li><code>‘date’ =&gt; ‘nullable | date’</code></li></ul></li></ul></li></ul></li> <li><p><strong>Form Request Validation</strong></p> <ul><li><em>Create</em><div class="language-php extra-class"><pre class="language-php"><code>php artisan <span class="token argument-name">make</span><span class="token punctuation">:</span>request StoreBlogPost
</code></pre></div></li> <li><em>Rules</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token function">rules</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>
    ‘name’ <span class="token operator">=&gt;</span> ‘<span class="token class-name">required</span> <span class="token operator">|</span> <span class="token argument-name">max</span><span class="token punctuation">:</span><span class="token number">250</span>’ <span class="token punctuation">,</span>
    ‘age’ <span class="token operator">=&gt;</span> ‘required’
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><em>Authorize</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token comment"># Route::post (‘comment/{ commentPara }, …..)</span>
<span class="token function">authorize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// return true if user is authorized to comment</span>
  <span class="token variable">$comment</span> <span class="token operator">=</span> <span class="token class-name static-context">Comment</span><span class="token operator">::</span><span class="token function">find </span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">route </span><span class="token punctuation">(</span>‘commentPara’<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token variable">$comment</span>  <span class="token operator">&amp;&amp;</span>  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">can</span><span class="token punctuation">(</span>‘update’<span class="token punctuation">,</span> <span class="token variable">$comment</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// or</span>
  <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span> <span class="token comment"># return true for always authorized</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><em>Custom error messages</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>‘name<span class="token operator">.</span>required’ <span class="token operator">=&gt;</span> ‘Invalid <span class="token keyword">or</span> missing name<span class="token operator">.</span> Please check again’<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><em>Use in controller</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">store </span><span class="token punctuation">(</span><span class="token class-name type-declaration">StoreBlogRequest</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$valid</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p><strong>Manually create validators</strong></p> <ul><li>Not much usefull. see docs.</li></ul></li> <li><p><strong>Errors Messages</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$errors</span><span class="token operator">-&gt;</span><span class="token function">first </span><span class="token punctuation">(</span>‘email’<span class="token punctuation">)</span>      <span class="token comment"># 1st error for email field</span>
       <span class="token operator">-&gt;</span><span class="token function">get </span><span class="token punctuation">(</span>‘email’<span class="token punctuation">)</span>        <span class="token comment"># all errors for email field</span>
             <span class="token punctuation">(</span>‘projects<span class="token operator">.</span><span class="token operator">*</span>’<span class="token punctuation">)</span>   <span class="token comment"># all errors for array</span>
       <span class="token operator">-&gt;</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment"># all errors all fields</span>
       <span class="token operator">-&gt;</span><span class="token function">has </span><span class="token punctuation">(</span>‘email’<span class="token punctuation">)</span>        <span class="token comment"># check if error for email field</span>
       <span class="token operator">-&gt;</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment"># check if any error in any field</span>
</code></pre></div></li></ul> <h3 id="error-handling"><a href="#error-handling" class="header-anchor">#</a> # ERROR HANDLING</h3> <ul><li><strong>APP_DEBUG option in .env</strong> <ul><li><em>true</em> = development</li> <li><em>false</em> = production</li></ul></li> <li><strong>Exception Handler Class</strong> <ul><li><em>App\Exception\Handler</em></li> <li><em>report()</em> <ul><li><em>log</em> or <em>send</em> exceptions to <code>bugsnag/sentry</code></li> <li>Passes exception to base class for logging</li> <li>Custom way to handle any exception
<ul><li><code>if ($exception instanceof CustomException) { …….. }</code></li></ul></li> <li><code>report()</code> (helper method)
<ul><li>Reports exception &amp; continues execution</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token comment"># code…..</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">report </span><span class="token punctuation">(</span><span class="token variable">$e</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  report <span class="token constant boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><em>Ignore Exceptions</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">protected</span> <span class="token variable">$dontreport</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>Illuminate<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>AuthenticationException</span><span class="token operator">::</span><span class="token keyword">class</span> <span class="token punctuation">,</span>
	<span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>ModelNotFoundException</span><span class="token operator">::</span><span class="token keyword">class</span>
<span class="token punctuation">]</span>
</code></pre></div></li> <li><em>render()</em> <ul><li>Generates <code>http</code> response</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$exception</span> <span class="token keyword">instanceof</span> <span class="token class-name">CustomException</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">view </span><span class="token punctuation">(</span>‘errors<span class="token operator">.</span>custom’<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><em>Custom class</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">class</span> MyException <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> ……<span class="token operator">.</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">render </span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> ……<span class="token operator">.</span><span class="token operator">.</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><em>HTTP Exceptions</em> <ul><li><code>abort()</code></li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">abort </span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">,</span> “Unauthorized action”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>Views to edit
<ul><li><code>views/errors/404.blade.php</code></li> <li><code>php artisan vendor:publlish --tag=laravel</code></li></ul></li></ul></li></ul></li></ul> <h3 id="logging"><a href="#logging" class="header-anchor">#</a> # LOGGING</h3> <ul><li>Uses <em>Monolog</em> library</li> <li><strong>config/logging.php</strong> <ul><li><em>Channel drivers</em> <ul><li><code>stack (multi-channel)</code> - syslog</li> <li><code>single</code> - errorlog</li> <li><code>daily</code> - monolog</li> <li><code>slack</code> - custom</li></ul></li></ul></li> <li>see docs for details</li></ul> <h3 id="blade"><a href="#blade" class="header-anchor">#</a> # BLADE</h3> <ul><li><p><strong>Introduction</strong></p> <ul><li><p><em>Layout Master</em> (<code>layouts/app.blade.php</code>)</p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token keyword">yield</span> <span class="token punctuation">(</span>‘title’<span class="token punctuation">)</span>                <span class="token comment"># define</span>
@<span class="token function">section </span><span class="token punctuation">(</span>“sidebar”<span class="token punctuation">)</span>
……<span class="token operator">.</span><span class="token operator">.</span>
@show                           <span class="token comment"># both define &amp; yield section</span>
</code></pre></div></li> <li><p><em>Extending layout</em> (<code>child.blade.php</code>)</p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token keyword">extends</span> <span class="token punctuation">(</span>‘layouts<span class="token operator">.</span>app’<span class="token punctuation">)</span>

@<span class="token function">section </span><span class="token punctuation">(</span>‘title’<span class="token punctuation">,</span> “This is title”<span class="token punctuation">)</span>

@<span class="token function">section </span><span class="token punctuation">(</span>‘title’<span class="token punctuation">)</span> ……<span class="token operator">.</span>………<span class="token operator">.</span> @endsection

@<span class="token function">section </span><span class="token punctuation">(</span>“sidebar”<span class="token punctuation">)</span>
  @<span class="token keyword">parent</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span> Appended after <span class="token keyword">parent</span>’s content <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
@endsection
</code></pre></div><ul><li><em>Usage</em> : <code>return view (“child’);</code></li></ul></li></ul></li> <li><p><strong>Components &amp; slots</strong></p> <ul><li><p><em>Component</em> (<code>alert.blade.php</code>)</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span>”alert” <span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token variable">$msg</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token variable">$slot</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div></li> <li><p><em>Usage</em></p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token function">component </span><span class="token punctuation">(</span>‘alert’<span class="token punctuation">)</span>
  @<span class="token function">slot </span><span class="token punctuation">(</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">)</span>
    <span class="token comment"># code</span>
  @endslot
  …<span class="token operator">.</span><span class="token operator">.</span>This comes <span class="token class-name type-declaration">in</span> <span class="token variable">$slot</span> variable
@endcomponent

@<span class="token function">component </span><span class="token punctuation">(</span>“alert”<span class="token punctuation">,</span> <span class="token punctuation">[</span>‘foo’ <span class="token operator">=&gt;</span> ‘bar’<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment"># Pass data directly</span>
</code></pre></div></li> <li><p><em>Aliasing</em></p> <ul><li><code>views/components/alert.blade.php</code><div class="language-php extra-class"><pre class="language-php"><code><span class="token comment"># AppServiceProvider</span>
<span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	 <span class="token punctuation">{</span>
 	<span class="token class-name static-context">Blade</span><span class="token operator">::</span><span class="token function">component </span><span class="token punctuation">(</span>“componets<span class="token operator">.</span>alert” <span class="token punctuation">,</span> “alert”<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div></li> <li><em>Usage</em> <ul><li><code>@alert ... @endalert</code></li></ul></li></ul></li></ul></li> <li><p><strong>Display data</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token variable">$name</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>                  <span class="token comment"># variable</span>
<span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>                 <span class="token comment"># Function / method</span>
<span class="token punctuation">{</span><span class="token operator">!</span><span class="token operator">!</span> <span class="token variable">$name</span> <span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">}</span>                <span class="token comment"># Unescaped data</span>
</code></pre></div><ul><li><em>Unrendered</em> (Vue / React js variables)<div class="language-php extra-class"><pre class="language-php"><code>@<span class="token punctuation">{</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token comment"># OR</span>
@verbatim
	<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
@endverbatim
</code></pre></div></li> <li><em>JSON</em> <ul><li><code>&lt;script&gt; var a = @json ($array); &lt;/script&gt;</code></li></ul></li></ul></li> <li><p><strong>Control structures</strong></p> <ul><li><p><em>IF</em></p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span>
……<span class="token operator">.</span>
@<span class="token keyword">elseif</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span>
……<span class="token operator">.</span>
@<span class="token keyword">else</span>
…<span class="token operator">...</span>
@<span class="token keyword">endif</span>
</code></pre></div></li> <li><p><em>Auth</em></p> <div class="language-php extra-class"><pre class="language-php"><code>@auth ……<span class="token operator">.</span>… @endauth               <span class="token comment"># also @auth (“guardname”)</span>
@guest ……<span class="token operator">...</span><span class="token operator">.</span> @endguest           <span class="token comment"># also @guest (“admin”)</span>
</code></pre></div></li> <li><p><em>Switch</em></p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span>
	@<span class="token keyword">case</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		………
		@<span class="token keyword">break</span>
	@<span class="token keyword">case</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
		………
	@<span class="token keyword">default</span>
		………
@<span class="token keyword">endswitch</span>
</code></pre></div></li> <li><p><em>Loop</em></p> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token variable">$a</span> <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token variable">$a</span><span class="token operator">++</span><span class="token punctuation">)</span>
@<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$users</span> <span class="token keyword">as</span> <span class="token variable">$user</span><span class="token punctuation">)</span>
@<span class="token keyword">while</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span>

@condition <span class="token operator">&amp;</span> @<span class="token keyword">break</span>

<span class="token comment"># $loop</span>
<span class="token variable">$loop</span><span class="token operator">-&gt;</span><span class="token property">first</span>
     <span class="token operator">-&gt;</span><span class="token property">last</span>
     <span class="token operator">-&gt;</span><span class="token property">index</span>
     <span class="token operator">-&gt;</span><span class="token keyword">parent</span><span class="token operator">-&gt;</span><span class="token property">first</span>
</code></pre></div></li> <li><p><em>Comment</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">--</span> This is a comment<span class="token operator">.</span> Not shown in rendered html code <span class="token operator">--</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div></li> <li><p><em>Php code</em></p> <ul><li><code>@php ……….. @endphp</code></li></ul></li></ul></li> <li><p><strong>Forms</strong></p> <ul><li><code>@csrf</code></li> <li><code>@method (“put”);</code></li></ul></li> <li><p><strong>Include partial views</strong></p> <ul><li><code>@include (“partials.profile”, [“foo” =&gt; “bar”])</code></li> <li><em>Aliasing</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token comment"># AppServiceProvider</span>
<span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
	<span class="token class-name static-context">Blade</span><span class="token operator">::</span><span class="token keyword">include</span> <span class="token punctuation">(</span>“partials<span class="token operator">.</span>profile”<span class="token punctuation">,</span> “profile”<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><em>Usage</em> : <code>@profile([“foo” =&gt; “bar”])</code></li></ul></li></ul></li> <li><p><strong>Stacks</strong></p> <ul><li><code>@stack (“script”)</code></li> <li><em>Usage</em> :
<ul><li><code>@push (“script”) .... @endpush</code></li></ul></li></ul></li> <li><p><strong>Extend Blade</strong></p> <div class="language-php extra-class"><pre class="language-php"><code># AppServiceProvider
boot() {
  Blade::directive (“datetime”, function ($t) {
    return “ <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$t</span><span class="token operator">-&gt;</span><span class="token function">format </span><span class="token punctuation">(</span>“m<span class="token operator">/</span>d<span class="token operator">/</span>y <span class="token argument-name">H</span><span class="token punctuation">:</span>i “<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre></div><ul><li><em>Usage</em> : <code>@datetime ($time)</code></li></ul></li></ul> <h3 id="localization"><a href="#localization" class="header-anchor">#</a> # LOCALIZATION</h3> <ul><li>see docs</li></ul> <h3 id="frontend-scaffholding"><a href="#frontend-scaffholding" class="header-anchor">#</a> # FRONTEND SCAFFHOLDING</h3> <ul><li><strong>Package.json</strong> (<em>Bootstrap, Axios, Vue, Jquery, etc</em>)<div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span>
<span class="token function">npm</span> run dev
        <span class="token function">watch</span>
</code></pre></div></li> <li>Laravel Mix configs in <code>Webpack.mix.js</code></li> <li><strong>Remove</strong> (<em>Bootstrap, Vue</em>)
<ul><li><code>php artisan preset none</code></li></ul></li> <li><strong>css</strong> <ul><li><code>resources/sass/</code> TO <code>public/css</code></li></ul></li> <li><strong>js</strong> <ul><li><code>resources/js</code> TO <code>public/js</code></li> <li><em>Vue</em> <ul><li><code>resources/js/components/ExampleComponent.vue</code></li> <li>Single file has <code>&lt;template&gt;, &lt;script&gt;, &lt;style&gt;</code></li> <li><code>Vue.component (‘example’, require (‘./components/ExampleComponent.vue’))</code></li> <li>Usage :- <code>&lt; vc-foo &gt; …… &lt;/ vc-foo &gt;</code></li></ul></li> <li><em>React</em> <ul><li><code>php artisan preset react</code></li></ul></li></ul></li></ul> <h3 id="compiling-assets-mix"><a href="#compiling-assets-mix" class="header-anchor">#</a> # COMPILING ASSETS (MIX)</h3> <ul><li>Mix make Webpack easier using <code>Webpack.mix.js</code><div class="language-js extra-class"><pre class="language-js"><code>mix<span class="token punctuation">.</span><span class="token function">js</span> <span class="token punctuation">(</span>“resources<span class="token operator">/</span>js<span class="token operator">/</span>app<span class="token punctuation">.</span>js”<span class="token punctuation">,</span> “<span class="token keyword">public</span><span class="token operator">/</span>js”<span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">sass</span> <span class="token punctuation">(</span>“resources<span class="token operator">/</span>css<span class="token operator">/</span>app<span class="token punctuation">.</span>scss”<span class="token punctuation">,</span> “<span class="token keyword">public</span><span class="token operator">/</span>css”<span class="token punctuation">)</span>
</code></pre></div></li> <li>Needs <em>nodejs</em> with npm installed</li> <li><strong>Install packages</strong> :- <code>npm install</code></li> <li><strong>Run</strong> <ul><li><code>npm run dev | production | watch | watch-poll</code></li></ul></li> <li><strong>Working with js</strong> <ul><li><em>Vendor extraction</em> <ul><li><code>mix.js (….).extract ([“vue”])</code></li> <li>Gives 3 files <code>manifest.js, vendor.js, app.js</code> (sequence must be same in <code>&lt;html&gt;</code>)</li> <li>why to use ? If updates are frequent then avoid compiling vendors again &amp; again.</li></ul></li></ul></li> <li><strong>Version / Cache Busting</strong> <ul><li>Appends a <em>hash</em> to filename</li> <li><code>mix.js (……..) . version()</code></li> <li>usage :</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token operator">&lt;</span>script src <span class="token operator">=</span> ‘ <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">mix </span><span class="token punctuation">(</span>“js<span class="token operator">/</span>app<span class="token operator">.</span>js”<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> ‘ <span class="token operator">&gt;</span>
</code></pre></div><ul><li>Only in production. Not use in development.<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>mix<span class="token punctuation">.</span><span class="token function">inProduction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  mix<span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><strong>BrowserSync</strong> <ul><li>Moniters files for any changes &amp; if changed then browser is refreshed automatically.</li> <li><code>mix.browserSync (“domain.test”)</code></li> <li>Run :- <code>npm run watch/watch-poll</code></li></ul></li></ul> <h1 id="security"><a href="#security" class="header-anchor">#</a> SECURITY</h1> <h3 id="authentication"><a href="#authentication" class="header-anchor">#</a> # AUTHENTICATION</h3> <ul><li><p><strong>Introduction</strong></p> <ul><li><code>php artisan make:auth</code></li> <li><code>config/auth.php</code></li> <li>Based on <code>guards</code> <em>(web/api)</em> &amp; <code>providers</code> <em>(eloquent/query with user table)</em></li> <li><code>App\Users</code> table model is used</li></ul></li> <li><p><strong>Auth Quickstart</strong></p> <ul><li><em>Controllers</em> <ul><li><code>HomeController</code></li> <li><code>App\Http\Controllers\Auth</code> <ul><li><em>Register, Login, ForgotPassword, ResetPassword</em></li> <li><code>$redirectTo</code> &amp; <code>redirect()</code> (Also <em>RedirectIfAuthenticated</em> middleware)</li></ul></li></ul></li> <li><em>Routes</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">(</span><span class="token punctuation">[</span>“register” <span class="token operator">=&gt;</span> “<span class="token constant boolean">false</span>”<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment"># If not needed</span>
</code></pre></div></li> <li><em>Views</em> : <code>resources/views/auth &amp; layouts</code></li> <li><em>Username</em> <ul><li><code>“email”</code> field is default</li> <li>If others, then use this method in <em>loginController</em> <ul><li><code>public function username() { return “username”; }</code></li></ul></li></ul></li> <li><em>Guard</em> <ul><li>In <em>Login, Register, ResetPassword</em> controllers</li> <li><code>public function guard() { return Auth::guard (“name”); }</code></li></ul></li> <li><em>Create &amp; Validation Of Users</em> <ul><li><em>RegisterController</em> has methods <code>validate() &amp; create()</code></li></ul></li> <li><em>Retrieve auth users</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">::</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">::</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><em>Login Throttling</em> <ul><li>Based on unique username &amp; IP address</li></ul></li></ul></li> <li><p><strong>Manually auth users</strong></p> <ul><li>Incase manual we must ignore default controllers</li> <li><em>attempt()</em> <ul><li><em>Credentials</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$credentials</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">only </span><span class="token punctuation">(</span>‘email’<span class="token punctuation">,</span> ‘password’<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">attempt </span><span class="token punctuation">(</span><span class="token variable">$credentials</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">intended </span><span class="token punctuation">(</span>“dashboard”<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><em>Specific guard</em> : <code>Auth::guard (‘admin’)-&gt;attempt ($credentials)</code></li></ul></li> <li><em>Logout</em> : <code>Auth::logout()</code></li> <li><em>Remember me</em> <ul><li><code>remember_token</code> in <em>users</em> table as hash values (<em>LoginController</em> already has this)</li> <li><code>Auth::attempt ($credentials, $remember)</code></li></ul></li> <li><em>Other auth ways</em> <ul><li>User Instance
<ul><li>Needs <em>Authenticable</em> contract (<code>App\User</code> implements this contract)</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">login </span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># remember me checked</span>
</code></pre></div></li></ul></li></ul></li> <li><p><strong>Http Basic auth</strong></p> <ul><li><em>Browser Prompt</em> is used. So dedicated login view pages required</li> <li>Use <code>auth.basic</code> middleware</li></ul></li> <li><p><strong>Add Custom Guards &amp; User Providers</strong></p> <ul><li>see docs</li></ul></li> <li><p><strong>Events</strong></p> <ul><li><em>EventServiceProvider</em></li> <li><em>Registered, Login, Attempting, Authenticated, Failed, Logout, Lockout, PasswordReset</em></li></ul></li></ul> <h3 id="api-auth-passport"><a href="#api-auth-passport" class="header-anchor">#</a> # API AUTH PASSPORT</h3> <ul><li>see docs.</li></ul> <h3 id="authorization"><a href="#authorization" class="header-anchor">#</a> # AUTHORIZATION</h3> <ul><li><p>Authorize a user to use a given resource.</p></li> <li><p><em>Gates</em>(closure) &amp; <em>Policies</em>(logic group) are like <em>Routes</em> &amp; <em>Controllers</em></p></li> <li><p>Both <em>Gates</em> &amp; <em>Policies</em> return <em>false</em> if request is not from logged-in user. Also see Guest below.</p></li> <li><p><strong>Gates</strong></p> <ul><li><p><em>Writing</em></p> <ul><li>In <code>App\Providers\AuthServiceProvider</code></li> <li>Always <code>$user</code> instance as first argument. Rest are optional arguments.</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">registerPolicies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment"># closure based</span>
  <span class="token class-name static-context">Gate</span><span class="token operator">::</span><span class="token function">define </span><span class="token punctuation">(</span>“update<span class="token operator">-</span>post”<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token variable">$post</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token property">id</span> <span class="token operator">==</span> <span class="token variable">$post</span><span class="token operator">-&gt;</span><span class="token property">user_id</span><span class="token punctuation">;</span>
  <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment"># class@method</span>
  <span class="token class-name static-context">Gate</span><span class="token operator">::</span><span class="token function">define </span><span class="token punctuation">(</span>“update<span class="token operator">-</span>post”<span class="token punctuation">,</span> “App\Policies\PostPolicy@update”<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><em>Resource Gates</em> <ul><li><code>Gate::resource (“posts”, “App\Policies\PostPolicy”);</code></li> <li>Total 4 gates
<ul><li><code>posts.view [view, create, update, delete]</code></li> <li><code>PostPolicy@view [view, create, update, delete]</code></li></ul></li></ul></li></ul></li> <li><p><em>Authorizing actions</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Gate</span><span class="token operator">::</span><span class="token function">allows </span><span class="token punctuation">(</span>“update<span class="token operator">-</span>post”<span class="token punctuation">,</span> <span class="token variable">$post</span><span class="token punctuation">)</span>     <span class="token comment"># true/false</span>
    <span class="token operator">::</span><span class="token function">denies </span><span class="token punctuation">(</span>“update<span class="token operator">-</span>post”<span class="token punctuation">,</span> <span class="token variable">$post</span><span class="token punctuation">)</span>     <span class="token comment"># note : $user is not needed to pass</span>

<span class="token class-name static-context">Gate</span><span class="token operator">::</span><span class="token function">forUser </span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">allows </span><span class="token punctuation">(</span>“update<span class="token operator">-</span>post”<span class="token punctuation">,</span> <span class="token variable">$post</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p><strong>Policies</strong></p> <ul><li>Uses model or resource</li> <li>Stored in <code>app/Policies</code></li> <li><code>php artisan make:policy PostPolicy --model=Post</code></li> <li><em>Register</em> <ul><li>In <code>AuthServiceProvider</code> register model-policy relations</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">protected</span> <span class="token variable">$policies</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span> <span class="token operator">=&gt;</span> <span class="token class-name static-context">PostPolicy</span><span class="token operator">::</span><span class="token keyword">class</span> <span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div></li> <li><em>Writing</em> <ul><li>In <code>Policies/PostPolicy</code> define methods with any names.</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">update </span><span class="token punctuation">(</span><span class="token class-name type-declaration">User</span> <span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Post</span> <span class="token variable">$post</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token property">id</span> <span class="token operator">==</span> <span class="token variable">$post</span><span class="token operator">-&gt;</span><span class="token property">user_id</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>Sometimes other model instance is not needed
<ul><li><code>create (User $user) { ……. }</code></li></ul></li> <li><em>Guest</em> <ul><li>Login is must to use <em>gates &amp; policies</em></li> <li>Optional <code>$user</code> can work for guest</li> <li><code>update (?User $user, Post $post) { ….. }</code></li></ul></li> <li><em>Admin</em> <ul><li>Must returns true for all policy methods. Use <code>before()</code></li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">before </span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token variable">$ability</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">isSuperAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul></li> <li><p><strong>Authorizing actions using policies</strong></p> <ul><li><p><em>Via User Model</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">can </span><span class="token punctuation">(</span>“update”<span class="token punctuation">,</span> <span class="token variable">$post</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># true / false</span>
     <span class="token operator">-&gt;</span><span class="token function">cant </span><span class="token punctuation">(</span>“update”<span class="token punctuation">,</span> <span class="token variable">$post</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>First call <code>policy@method</code>. If Not found then call <em>Gate</em> closure</li> <li><em>Create</em> <ul><li>Without <code>$post</code> variable - <code>$user-&gt;can (“create”, Post::class);</code></li></ul></li></ul></li> <li><p><em>Via Middleware</em></p> <ul><li>Key in Http\Kernel - <code>‘can’ =&gt; ‘Illuminate\Auth]Middleware\Authorize’</code></li> <li>see docs</li></ul></li> <li><p><em>Via Controller Helpers</em></p> <ul><li><code>authorize()</code> method in base Controller</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">update </span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Post</span> <span class="token variable">$post</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">authorize </span><span class="token punctuation">(</span>“update”<span class="token punctuation">,</span> <span class="token variable">$post</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment"># Run if true</span>
<span class="token punctuation">}</span>

<span class="token function">create </span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">authorize </span><span class="token punctuation">(</span>‘create’<span class="token punctuation">,</span> <span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment"># run if true</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><em>Via Blade Templates</em></p> <ul><li><code>@can &amp; @cannot</code></li></ul> <div class="language-php extra-class"><pre class="language-php"><code>@<span class="token function">can </span><span class="token punctuation">(</span>“update”<span class="token punctuation">,</span> <span class="token variable">$post</span><span class="token punctuation">)</span>
……<span class="token operator">.</span><span class="token operator">.</span>
@<span class="token function">elsecan </span><span class="token punctuation">(</span>“create”<span class="token punctuation">,</span> <span class="token class-name class-name-fully-qualified static-context">App<span class="token punctuation">\</span>Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span>
……<span class="token operator">.</span>
@endcan
</code></pre></div></li></ul></li></ul> <h3 id="email-verification"><a href="#email-verification" class="header-anchor">#</a> # EMAIL VERIFICATION</h3> <ul><li><strong>Introduction</strong> <ul><li><em>Model preparation</em> <ul><li><code>App\User</code> must implement <code>Illuminate\Contracts\Auth\MustVerifyEmail</code></li></ul></li></ul></li> <li><strong>Database Considerations</strong> <ul><li><code>users</code> table must have <code>email_verified_at</code></li></ul></li> <li><strong>Route</strong> <ul><li>Logic for sending emails - <code>Auth\VerificationController</code></li> <li><code>Auth::routes ([‘verify’ =&gt; true])</code></li> <li>Use <code>verify</code> middleware which is <code>Illuminate\Auth\Middleware\EnsureEmailIsVerified</code></li></ul></li> <li><strong>Views</strong> <ul><li><code>resources/views/auth/verify.blade.php</code></li></ul></li> <li><strong>After verifying emails</strong> <ul><li>In VerificationController - <code>protected $redirectTo = “/dashboard”</code></li></ul></li> <li><strong>Events</strong> <ul><li>Verified event</li></ul></li></ul> <h3 id="encryption"><a href="#encryption" class="header-anchor">#</a> # ENCRYPTION</h3> <ul><li><em>OpenSSL</em> provides AES-256 / AES-128</li> <li>All encrypted values are signed with <em>MAC</em> (Message Authentication code)</li> <li><code>php artisan key:generate</code> // Gives AES-256-CBC key in .env</li> <li><strong>Using the encrypter</strong> <ul><li><code>encrypt ($request-&gt;secretmsg)</code></li> <li>Uses <strong>serialize</strong> during encryption for <em>objects &amp; arrays</em></li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Crypt</span><span class="token operator">::</span><span class="token function">encryptString </span><span class="token punctuation">(</span>‘hello’<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token operator">::</span> <span class="token function">decryptString </span><span class="token punctuation">(</span><span class="token variable">$encryptedKey</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="hashing"><a href="#hashing" class="header-anchor">#</a> # HASHING</h3> <ul><li><em>Bcrypt &amp; Argon2</em> algorithms are available for passwords. Bcrypt is default for laravel</li> <li><code>config/hashing.php</code><div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Hash</span><span class="token operator">::</span><span class="token function">make </span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">::</span><span class="token function">check </span><span class="token punctuation">(</span>“plainText”<span class="token punctuation">,</span> <span class="token variable">$hashedPassword</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">::</span> <span class="token function">needsRehash </span><span class="token punctuation">(</span><span class="token variable">$hasedPassword</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># true / false</span>
</code></pre></div></li></ul> <h3 id="reset-password"><a href="#reset-password" class="header-anchor">#</a> # RESET PASSWORD</h3> <ul><li>User must use trait <code>Illuminate\Notifications\Notifiable</code></li> <li>Reset tokens expires after 1 hour. See expire option in <code>config/auth.php</code> <ul><li><strong>Database</strong> <ul><li><code>App\User</code> must implements <code>Illuminate\Contracts\Auth\CanResetPassword</code></li> <li>DB table is already added in migration.</li></ul></li> <li><strong>Route</strong> <ul><li><code>Auth\ForgetPasswordController</code> &amp; <code>Auth\ResetPasswordController</code></li></ul></li> <li><strong>Views</strong> <ul><li><code>resources/views/auth/passwords</code></li></ul></li> <li><strong>After Reset</strong> <ul><li>Browser visit <em>“/password/reset”</em></li> <li><code>$redirectTo</code> property after reset of password.</li></ul></li></ul></li></ul> <h3 id="artisan-console"><a href="#artisan-console" class="header-anchor">#</a> # ARTISAN CONSOLE</h3> <ul><li><p><strong>Introduction</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>php artisan list
            <span class="token builtin class-name">help</span> <span class="token operator">&lt;</span>cmd<span class="token operator">&gt;</span>
            tinker
            make:command MyCmd
</code></pre></div></li> <li><p><strong>Writing commands</strong></p> <ul><li><p>Custom commands are stored in app/Console/Commands</p></li> <li><p>php artisan make:command SendEmails</p></li> <li><p><em>SendEmails class based</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$signature</span> <span class="token operator">=</span> “<span class="token argument-name">email</span><span class="token punctuation">:</span>send <span class="token punctuation">{</span> user <span class="token punctuation">}</span> “<span class="token punctuation">;</span>
<span class="token variable">$description</span> <span class="token operator">=</span> “Send drip emails to a user”<span class="token punctuation">;</span>

<span class="token function">handle </span><span class="token punctuation">(</span><span class="token class-name type-declaration">DripEmailer</span> <span class="token variable">$drip</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$drip</span><span class="token operator">-&gt;</span><span class="token function">send </span><span class="token punctuation">(</span><span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">find </span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">argument </span><span class="token punctuation">(</span>“user”<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><em>Closure based</em></p> <ul><li><code>routes/console.php</code> is where closure based commands are defined</li> <li>Not <code>http</code> routes but <code>console</code> based entry points</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Artisan</span><span class="token operator">::</span><span class="token function">command </span><span class="token punctuation">(</span>“build <span class="token punctuation">{</span> project <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$project</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$this</span> <span class="token operator">-&gt;</span><span class="token function">info </span><span class="token punctuation">(</span>“Building <span class="token punctuation">{</span> project <span class="token punctuation">}</span> “<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">describe </span><span class="token punctuation">(</span>“Build the proect “<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Artisan</span><span class="token operator">::</span><span class="token function">command </span><span class="token punctuation">(</span>“<span class="token argument-name">email</span> <span class="token punctuation">:</span> send <span class="token punctuation">{</span> user <span class="token punctuation">}</span> “<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name type-declaration">DripEmailer</span> <span class="token variable">$drip</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$drip</span><span class="token operator">-&gt;</span><span class="token function">send </span><span class="token punctuation">(</span><span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">find </span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p><strong>Defining Input expectations</strong></p> <ul><li><em>Arguments</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$signature</span> <span class="token operator">=</span> “<span class="token argument-name">email</span> <span class="token punctuation">:</span> send <span class="token punctuation">{</span> user <span class="token punctuation">}</span> “
                           <span class="token punctuation">{</span> user<span class="token operator">?</span> <span class="token punctuation">}</span>        <span class="token comment"># Optional</span>
                           <span class="token punctuation">{</span> user<span class="token operator">=</span>foo <span class="token punctuation">}</span>     <span class="token comment"># Defualt</span>
</code></pre></div></li> <li><em>Options</em> <ul><li>2 types based on option value received or not .</li> <li>If not option value is not received then it acts as true/false<div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$signature</span> <span class="token operator">=</span> “ <span class="token argument-name">email</span> <span class="token punctuation">:</span> send <span class="token punctuation">{</span> user <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token operator">--</span>queue <span class="token punctuation">}</span> “<span class="token punctuation">;</span>           <span class="token comment"># true / false</span>
                                    <span class="token punctuation">{</span> <span class="token operator">--</span>queue<span class="token operator">=</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>            <span class="token comment"># value is needed</span>
                                    <span class="token punctuation">{</span> <span class="token operator">--</span>queue<span class="token operator">=</span><span class="token keyword">default</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>     <span class="token comment"># default value</span>
                                    <span class="token punctuation">{</span> <span class="token operator">--</span><span class="token class-name">Q</span><span class="token operator">|</span><span class="token class-name">queue</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>           <span class="token comment"># shortcut</span>
</code></pre></div></li></ul></li></ul></li> <li><p><strong>Command IO</strong></p> <ul><li><p><em>Retrieving input</em></p> <ul><li><p><em>In handle() method</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$userId</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">argument </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment"># All args as array</span>
                          <span class="token punctuation">(</span>“user”<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment"># only user</span>
<span class="token variable">$queueName</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment"># All options as array</span>
                          <span class="token punctuation">(</span>“queue”<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment"># only queue</span>
</code></pre></div></li> <li><p><em>Prompt for input</em></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">ask </span><span class="token punctuation">(</span>“what is your name”<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token operator">-&gt;</span><span class="token function">secret </span><span class="token punctuation">(</span>“type password”<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">confirm </span><span class="token punctuation">(</span>“<span class="token keyword">Do</span> you wish to <span class="token keyword">continue</span> <span class="token operator">?</span>“<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment"># true if “y” / “yes”</span>
</code></pre></div></li></ul></li> <li><p><em>Display output</em></p> <ul><li>In <code>handle()</code> method
<ul><li><code>$this-&gt;info (“Display this on the screen”)</code></li></ul></li> <li><em>info</em> (green), <em>error</em> (red), <em>line</em> (plain uncolored), <em>question</em>, <em>comment</em></li></ul></li> <li><p><em>Table layout / Progress bars</em></p> <ul><li>See docs</li></ul></li></ul></li> <li><p><strong>Registering command</strong></p> <ul><li><code>app/Console/Commands</code> directory’s all commands are automatically registered by kernel</li></ul></li> <li><p><strong>Programmatically Executing Commands</strong></p> <ul><li>To execute cmd from say controller or route and not in <em>CLI</em> (command line interface)</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$exitCode</span> <span class="token operator">=</span> <span class="token class-name static-context">Artisan</span><span class="token operator">::</span><span class="token function">call </span><span class="token punctuation">(</span>“<span class="token argument-name">email</span><span class="token punctuation">:</span>send”<span class="token punctuation">,</span> <span class="token punctuation">[</span>“user” <span class="token operator">=&gt;</span> <span class="token number">12</span><span class="token punctuation">,</span> “<span class="token operator">--</span>queue” <span class="token operator">=&gt;</span> “<span class="token keyword">default</span>”<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   <span class="token operator">::</span><span class="token function">queue </span><span class="token punctuation">(</span>…<span class="token operator">.</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">onConnection </span><span class="token punctuation">(</span>‘redis’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">onQueue </span><span class="token punctuation">(</span>“commands”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="broadcast-pusher"><a href="#broadcast-pusher" class="header-anchor">#</a> # BROADCAST (Pusher)</h3> <ul><li>Realtime / live updating user interfaces</li></ul> <h3 id="cache"><a href="#cache" class="header-anchor">#</a> # CACHE</h3> <ul><li><strong>Config</strong> <ul><li><code>config/cache.php</code> =&gt; drivers [<em>File, Database, Redis, Memcache</em>]</li> <li>See Docs for driver’s config.</li></ul></li> <li><strong>Cache usage</strong> <ul><li><em>Retrieve</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Cache</span><span class="token operator">::</span><span class="token function">get </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> ‘<span class="token keyword">default</span>’<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token operator">::</span> <span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> ……<span class="token operator">.</span><span class="token operator">.</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token operator">::</span> <span class="token function">store </span><span class="token punctuation">(</span>‘redis’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token operator">::</span> <span class="token function">has </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">)</span><span class="token punctuation">;</span>                          <span class="token comment"># check</span>
     <span class="token operator">::</span> <span class="token function">increment </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment"># ++ / -- integer value</span>
     <span class="token operator">::</span> <span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> <span class="token variable">$amount</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Retrieve &amp; store</em> <ul><li>Retrieve if present or add key in cache via function return</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Cache</span> <span class="token operator">::</span><span class="token function">remember </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> <span class="token variable">$minutes</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> …<span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token operator">::</span><span class="token function">rememberForever </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> …<span class="token operator">.</span><span class="token operator">.</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Retrieve &amp; delete</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Cache</span><span class="token operator">::</span><span class="token function">pull </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">)</span>
</code></pre></div></li> <li><em>Storing</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Cache</span><span class="token operator">::</span><span class="token function">put </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> ‘value’<span class="token punctuation">,</span> <span class="token variable">$minutes</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token operator">::</span><span class="token function">add </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> ‘value’<span class="token punctuation">,</span> <span class="token variable">$minute</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token operator">::</span><span class="token function">forever </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">,</span> ‘value’<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Remove</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">Cache</span><span class="token operator">::</span><span class="token function">forget </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token operator">::</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Atomic Locks</em> (redis or memcache only)
<ul><li>Used to avoid race conditions</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">Cache</span><span class="token operator">::</span><span class="token function">lock </span><span class="token punctuation">(</span>‘foo’<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment"># lock acquired for 10 seconds</span>
  <span class="token class-name static-context">Cache</span><span class="token operator">::</span><span class="token function">lock </span><span class="token punctuation">(</span>‘foo’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><em>Cache helper</em><div class="language-php extra-class"><pre class="language-php"><code><span class="token function">cache </span><span class="token punctuation">(</span>‘key’<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">(</span><span class="token punctuation">[</span>‘key’ <span class="token operator">=&gt;</span> ‘value’<span class="token punctuation">]</span> <span class="token punctuation">,</span><span class="token variable">$minutes</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><strong>Cache tags</strong> <ul><li>Note : Not supported for file &amp; database drivers</li> <li>Tag related items which helps in using &amp; removing them together</li> <li><em>Store</em> <ul><li><code>Cache::tags ([‘tag1’, ‘tag2’])-&gt;put (‘key’, $key, $minutes)</code></li></ul></li> <li><em>Access</em> <ul><li><code>Cache::tags ([‘tag1’, ‘tag2’])-&gt;get (‘key’)</code></li></ul></li> <li><em>Remove</em> <ul><li><code>Cache::tags ([‘tag1’, ‘tag2’])-&gt;flush()</code></li></ul></li></ul></li> <li><strong>Adding custom cache drivers (MongoDB)</strong> <ul><li>see docs</li></ul></li> <li><strong>Events</strong> <ul><li><em>CacheHit, CacheMissed, KeyForgotten, KeyWritten</em></li></ul></li></ul> <h3 id="collection"><a href="#collection" class="header-anchor">#</a> # COLLECTION</h3> <ul><li>Wrapper for arrays. Eloquent results are always collections</li> <li>Are <em>Immutable</em> meaning every method (<em>map, reject etc</em>) in chain returns new collection instance.</li> <li>To Uppercase and remove null values from array<div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$collect</span> <span class="token operator">=</span> <span class="token function">collect </span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘a’<span class="token punctuation">,</span> ‘b’<span class="token punctuation">,</span> <span class="token constant">null</span><span class="token punctuation">,</span> ‘c’<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">map </span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">strtoupper </span><span class="token punctuation">(</span><span class="token variable">$n</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                          <span class="token operator">-&gt;</span><span class="token function">reject </span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">empty</span> <span class="token punctuation">(</span><span class="token variable">$n</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><strong>Extending</strong><div class="language-php extra-class"><pre class="language-php"><code><span class="token comment"># In service provider</span>
<span class="token class-name static-context">Collection</span><span class="token operator">::</span><span class="token function">macro </span><span class="token punctuation">(</span>“toUpper”<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">map </span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name static-context">Str</span><span class="token operator">::</span><span class="token function">upper </span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># Usage</span>
<span class="token variable">$collect</span><span class="token operator">-&gt;</span><span class="token function">toUpper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><strong>Available Methods</strong> <ul><li><code>all(), map(), take(), count(), dd(), min(), toArray(), get(), isEmpty(), etc…</code></li> <li>See Docs. Lots of methods.</li></ul></li></ul> <h3 id="events"><a href="#events" class="header-anchor">#</a> # EVENTS</h3> <ul><li><p><code>app/Events</code> &amp; <code>app/Listeners</code></p></li> <li><p>1 Event can have many Listeners</p></li> <li><p><strong>Register</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment"># EventServiceProvider</span>
<span class="token keyword">protected</span> <span class="token variable">$listen</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  ‘App\Events\OrderShipped’ <span class="token operator">=&gt;</span> ‘App\Listeners\SendEmail’<span class="token punctuation">;</span>
<span class="token punctuation">]</span>
</code></pre></div><ul><li>All registered events &amp; listeners files will be automatically created by cmd
<ul><li><code>php artisan event:generate</code></li></ul></li> <li><em>Manual way</em> (closure based)<div class="language-php extra-class"><pre class="language-php"><code><span class="token comment"># EventServiceProvider</span>
<span class="token function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name static-context">Event</span><span class="token operator">::</span><span class="token function">listen </span><span class="token punctuation">(</span>‘event<span class="token operator">.</span>name’<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$foo</span><span class="token punctuation">,</span> <span class="token variable">$bar</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span><span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p><strong>Define Events</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment"># Events/OrderShipped</span>
<span class="token function">__construct </span><span class="token punctuation">(</span><span class="token class-name type-declaration">Order</span> <span class="token variable">$order</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">order</span> <span class="token operator">=</span> <span class="token variable">$order</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>Has <em>no logic but only data</em> of order instance purchased.</li></ul></li> <li><p><strong>Define Listeners</strong></p> <ul><li>In <code>Listeners/SendEmail</code> class - <code>handle (OrderShipped $event) { ……. }</code></li> <li>To stop propogation to other listeners of that events <code>return false;</code></li></ul></li> <li><p><strong>Queued Event Listners</strong></p> <ul><li>Queuing is useful if slow tasks like <em>sending email, http request, etc</em></li> <li>Configure &amp; start queue process on server to use queues for listeners</li> <li><em>Usage</em> : <code>class SendEmail implements ShouldQueue { ........ }</code></li> <li><em>Extra config</em> :<div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span>  <span class="token variable">$connection</span> <span class="token operator">=</span> ‘sqs’<span class="token punctuation">;</span>
        <span class="token variable">$queue</span> <span class="token operator">=</span> ‘listeners’<span class="token punctuation">;</span>
        <span class="token variable">$delay</span> <span class="token operator">=</span> ‘<span class="token number">60</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><em>Fails</em> : <code>public function failed (OrderShipped $event, $exception) { …. }</code></li></ul></li> <li><p><strong>Dispatch Events</strong></p> <ul><li><code>$order</code> instance - <code>event (new OrderShipped ($order));</code></li></ul></li> <li><p><strong>Event Subscribers</strong></p> <ul><li>A class which defines many event handlers.</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Listeners</span><span class="token punctuation">;</span>
  <span class="token keyword">class</span> <span class="token class-name">UserEventSubscriber</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">onUserLogin </span><span class="token punctuation">(</span><span class="token variable">$event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">onUserLogout </span><span class="token punctuation">(</span><span class="token variable">$event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">subscribe </span><span class="token punctuation">(</span><span class="token variable">$events</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token variable">$events</span><span class="token operator">-&gt;</span><span class="token function">listen </span><span class="token punctuation">(</span>‘Illuminate\Auth\Events\Login’<span class="token punctuation">,</span> ‘App\Listeners\UserEventSubscriber@onUserLogin’<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token variable">$events</span><span class="token operator">-&gt;</span><span class="token function">listen </span><span class="token punctuation">(</span>‘Illuminate\Auth\Events\Logout’<span class="token punctuation">,</span> ‘App\Listeners\UserEventSubscriber@onUserLogout’<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><ul><li><em>Register</em> (In <code>App\Providers\EventServiceProvider</code>)
<ul><li><code>protected $subscribe = [‘App\Listeners\UserEventSubscriber’]</code></li></ul></li></ul></li></ul> <h3 id="file-storage"><a href="#file-storage" class="header-anchor">#</a> # FILE STORAGE</h3> <ul><li><em>Flysystem</em> package</li> <li><em>Local / Amazon S3 / Rackspace</em></li> <li><code>storage/app/public</code></li> <li>Create <em>symboliclink</em> from <code>public/storage</code> to <code>storage/app/public</code></li> <li>Create symbolic link - <code>php artisan storage:link</code></li> <li><code>asset(‘storage/file.txt)</code></li></ul> <h3 id="mail"><a href="#mail" class="header-anchor">#</a> # MAIL</h3> <ul><li><p><strong>Mailgun.com</strong> ------&gt; 10000 mails/ month FREE</p></li> <li><p><em>Swiftmailer</em> php library</p></li> <li><p><em>SMTP / Mailgun / SparkPost / Amazon SES / php’s <code>mail() &amp; sendmail()</code></em></p></li> <li><p>Local or cloud based service</p></li> <li><p><em>Mailgun, SparkPost</em> --- faster than ---- <em>SMTP</em></p></li> <li><p><code>Composer require guzzlehttp/guzzle</code></p></li> <li><p><em>select driver</em> - <code>config/mail.php</code></p></li> <li><p><em>secret-key &amp;&amp; domain</em> - <code>config/services.php</code></p></li> <li><p><code>app/Mail</code> ------ each email sent is a <em>Mailable</em> class</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment"># php artisan make:mail MyMail</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">from</span><span class="token punctuation">(</span>“me@ex<span class="token operator">.</span>com”<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">view</span><span class="token punctuation">(</span>“myview”<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Global <code>from()</code> method in <code>config/mail.php</code></p></li> <li><p><code>attach(‘path/to/file’)</code></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span> <span class="token operator">=</span> <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">findOrFail</span><span class="token punctuation">(</span><span class="token variable">$userId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name static-context">Mail</span><span class="token operator">::</span><span class="token function">to </span><span class="token punctuation">(</span>“abc@exam<span class="token operator">.</span>com”<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyMail</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Mail</span><span class="token operator">::</span><span class="token function">to </span><span class="token punctuation">(</span>“abc@exam<span class="token operator">.</span>com”<span class="token punctuation">)</span>
<span class="token operator">-&gt;</span><span class="token function">cc</span><span class="token punctuation">(</span><span class="token variable">$ccUsers</span><span class="token punctuation">)</span>
<span class="token operator">-&gt;</span><span class="token function">bcc</span><span class="token punctuation">(</span><span class="token variable">$bccUsers</span><span class="token punctuation">)</span>
<span class="token operator">-&gt;</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyMail</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>Use <strong>queues</strong> for increased response time.</p></li></ul> <h3 id="notifications"><a href="#notifications" class="header-anchor">#</a> # NOTIFICATIONS</h3> <h3 id="package-development"><a href="#package-development" class="header-anchor">#</a> # PACKAGE DEVELOPMENT</h3> <h3 id="database"><a href="#database" class="header-anchor">#</a> # DATABASE</h3> <ul><li>Raw / query builder / eloquent ORM</li> <li><strong>Transactions</strong> (All or none)<div class="language-php extra-class"><pre class="language-php"><code><span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span>‘users’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘votes’ <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span>‘post’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                          <span class="token comment"># 5 = attempts after deadlock</span>
</code></pre></div></li></ul> <h3 id="query-builder"><a href="#query-builder" class="header-anchor">#</a> # QUERY BUILDER</h3> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span>‘users’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span>‘users’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">where</span><span class="token punctuation">(</span>‘name’<span class="token punctuation">,</span> ‘john’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span>‘users’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">where</span><span class="token punctuation">(</span>‘name’<span class="token punctuation">,</span> ‘john’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">value</span><span class="token punctuation">(</span>‘name’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">pluck</span><span class="token punctuation">(</span>‘anyCol’<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="pagination"><a href="#pagination" class="header-anchor">#</a> # PAGINATION</h3> <ul><li><code>paginate()</code><div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">#  query builder</span>
<span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span>‘users’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">paginate</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span>‘users’<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">simplePaginate</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># eloquent</span>
<span class="token class-name class-name-fully-qualified static-context">App<span class="token punctuation">\</span>User</span><span class="token operator">::</span><span class="token function">paginate</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name class-name-fully-qualified static-context">App<span class="token punctuation">\</span>User</span><span class="token operator">::</span><span class="token function">simplepaginate</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">-</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">links</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="migration"><a href="#migration" class="header-anchor">#</a> # MIGRATION</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>php artisan make:migration create_users_table --create<span class="token operator">=</span>users
<span class="token comment"># database/migrations</span>
php artisan migrate
php artisan migrate:refresh
php artisan migrate:refresh --seed
</code></pre></div><h3 id="seeds"><a href="#seeds" class="header-anchor">#</a> # SEEDS</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>php artisan make:seeder UsersTableSeeder
<span class="token comment"># DatabaseSeeder.php</span>
php artisan db:seed
</code></pre></div><h3 id="redis"><a href="#redis" class="header-anchor">#</a> # REDIS</h3> <ul><li>Advanced <code>key=value</code> store</li> <li>Keys can be ----&gt; <em>strings, hashes, lists, sets, sortedsets</em></li> <li>Composer require <em>predis/predis</em></li> <li>Use redis in <code>config/database.php</code></li></ul> <h3 id="eloquent"><a href="#eloquent" class="header-anchor">#</a> # ELOQUENT</h3> <ul><li>ORM</li> <li><strong>MODELS</strong> <ul><li>php artisan make:model User --migration</li> <li>php artisan make:model User --m</li> <li>protected $table = ‘users”;</li> <li>Protected $dateFormat = ‘U’</li></ul></li></ul> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">where</span><span class="token punctuation">(</span>‘active’<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">findOrFail</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-&gt;</span> <span class="token number">1</span>st row with id <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">where</span><span class="token punctuation">(</span>‘legs’<span class="token punctuation">,</span> ‘ ’<span class="token operator">&gt;</span>’<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">firstOrFail</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><p><strong>Inserts</strong></p> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token comment"># option 1 - new</span>
  <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token punctuation">;</span>
  <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment"># option 2 - find</span>
  <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">find </span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token property">name</span> <span class="token operator">=</span> “hello”<span class="token punctuation">;</span>
  <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>In model - <code>Protected $fillable = [‘name’];</code></li></ul> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘name’ <span class="token operator">=&gt;</span> ’ myname’<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘name’ <span class="token operator">=&gt;</span> ‘myname’<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">firstOrCreate</span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘name’ <span class="token operator">=&gt;</span> ’ myname’<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">firstOrNew</span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘name’ <span class="token operator">=&gt;</span> ’ myname’<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">updateOrCreate</span><span class="token punctuation">(</span><span class="token punctuation">[</span>‘name’ <span class="token operator">=&gt;</span> ’ myname’<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>‘age’ <span class="token operator">=&gt;</span> ‘<span class="token number">26</span>’<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>Delete</strong></p> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="relationship"><a href="#relationship" class="header-anchor">#</a> # RELATIONSHIP</h3> <ul><li><p>Methods in model</p> <div class="language-php extra-class"><pre class="language-php"><code>  <span class="token comment"># 1 - 1</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">hasOne</span><span class="token punctuation">(</span>“Car’<span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment"># inside User.php model file</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">belongsTo</span><span class="token punctuation">(</span>“User’<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment"># inside Car.php model file</span>

  <span class="token comment"># 1 - *</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">hasMany</span><span class="token punctuation">(</span>“Car’<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment"># inside User.php model file</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">belongsTo</span><span class="token punctuation">(</span>“User’<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment"># inside Car.php model file</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">belongsToMany</span><span class="token punctuation">(</span>“Car’<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment"># inside User.php model file</span>
  <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">belongsToMany</span><span class="token punctuation">(</span>“User’<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment"># inside Car.php model file</span>
</code></pre></div></li></ul> <h3 id="accessor-mutators"><a href="#accessor-mutators" class="header-anchor">#</a> # ACCESSOR / MUTATORS</h3> <ul><li>Like Get / set</li> <li>Methods inside model<div class="language-php extra-class"><pre class="language-php"><code>  <span class="token comment"># first_name  is column name</span>
  <span class="token keyword">Public</span> <span class="token keyword">function</span> <span class="token function">getFirstNameAttribute </span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token keyword">return</span> <span class="token function">ucfirst</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">Public</span> <span class="token keyword">function</span> <span class="token function">setFirstNameAttribute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">attributes</span><span class="token punctuation">[</span>‘first_name’<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">strtolower </span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/9/2021, 3:00:14 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/technotes/assets/js/app.8104ebb8.js" defer></script><script src="/technotes/assets/js/2.caedfb41.js" defer></script><script src="/technotes/assets/js/42.61c3b5d8.js" defer></script>
  </body>
</html>
